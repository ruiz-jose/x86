const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-Cpo0d8wr.js","./vendor--f4DIBbt.js"])))=>i.map(i=>d[i]);
var er=Object.defineProperty;var tr=(e,t,n)=>t in e?er(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var A=(e,t,n)=>tr(e,typeof t!="symbol"?t+"":t,n);import{j as s,r as E,c as Re,a as ie,p as Rt,S as sr,i as nr,f as U,m as k,B as rr,d as ts,t as ar,b as or,e as ir,g as cr,h as lr,k as dr,l as bt,n as Et,o as ur,q as pr,s as St,u as hr,v as Fs,w as gr,A as mr,x as jt,y as yt,R as st,z as vt,C as _t,G as Vs,D as xr,E as J,F as oe,H as fr,O as Rr,I as Hs,J as br,K as Er,L as ss,M as Sr,N as wt,P as jr,Q as yr,T as vr,U as _r,V as wr,W as Dr,X as Ir,Y as Lr,Z as Ar,_ as Mr,$ as Cr,a0 as Nr,a1 as kr,a2 as Tr,a3 as Or,a4 as Gr,a5 as Br,a6 as Pr,a7 as Fr,a8 as Vr,a9 as Hr,aa as Ur,ab as $r,ac as Wr,ad as Jr}from"./vendor--f4DIBbt.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();const zr="text-blue-700 hover:underline",se=({href:e,className:t=zr,children:n})=>{const r=e.startsWith("http");return s.jsx("a",{className:t,href:e,...r?{rel:"noopener noreferrer",target:"_blank"}:{},children:n})},Kr=e=>s.jsx("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M13 7v-6l11 11-11 11v-6h-13v-10z"})}),Us=e=>s.jsx("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M0 7.33l2.829-2.83 9.175 9.339 9.167-9.339 2.829 2.83-11.996 12.17z"})}),$s=e=>s.jsx("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M0 16.67l2.829 2.83 9.175-9.339 9.167 9.339 2.829-2.83-11.996-12.17z"})}),we=e=>s.jsx("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M20.285 2l-11.285 11.567-5.286-5.011-3.714 3.716 9 8.728 15-15.285z"})}),Zr=e=>s.jsxs("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:[s.jsx("path",{d:"M23.954 21.03l-9.184-9.095 9.092-9.174-2.832-2.807-9.09 9.179-9.176-9.088-2.81 2.81 9.186 9.105-9.095 9.184 2.81 2.81 9.112-9.192 9.18 9.1z"})," "]}),Yr=e=>s.jsx("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M15.602 4.075c2.201 1.174 4.904 3.254 6.398 5.252-1.286-.9-3.011-1.027-5.058-.549.222-1.469-.185-3.535-1.34-4.703zm-.825 6.925s1.522-7-3.335-7h-5.442v20h16v-10.629c0-3.42-4.214-3.116-7.223-2.371zm-.777-9l-3-2h-9v22h2v-20h10z"})}),Xr=e=>s.jsx("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M14 12l-14 9v-18l14 9zm-4-9v4l8.022 5-8.022 5v4l14-9-14-9z"})}),qr=e=>s.jsx("svg",{viewBox:"0 0 480 512",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"})}),Qr=e=>s.jsx("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M14.601 21.5c0 1.38-1.116 2.5-2.499 2.5-1.378 0-2.499-1.12-2.499-2.5s1.121-2.5 2.499-2.5c1.383 0 2.499 1.119 2.499 2.5zm-2.42-21.5c-4.029 0-7.06 2.693-7.06 8h3.955c0-2.304.906-4.189 3.024-4.189 1.247 0 2.57.828 2.684 2.411.123 1.666-.767 2.511-1.892 3.582-2.924 2.78-2.816 4.049-2.816 7.196h3.943c0-1.452-.157-2.508 1.838-4.659 1.331-1.436 2.986-3.222 3.021-5.943.047-3.963-2.751-6.398-6.697-6.398z"})}),Ws=e=>s.jsx("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M3 22v-20l18 10-18 10z"})}),ea=e=>s.jsx("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"})}),ta=e=>s.jsxs("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:[s.jsx("path",{clipRule:"evenodd",d:"M12 19C15.866 19 19 15.866 19 12C19 8.13401 15.866 5 12 5C8.13401 5 5 8.13401 5 12C5 15.866 8.13401 19 12 19ZM12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z",fill:"currentColor",fillRule:"evenodd",opacity:"0.2"}),s.jsx("path",{d:"M2 12C2 6.47715 6.47715 2 12 2V5C8.13401 5 5 8.13401 5 12H2Z",fill:"currentColor"})]}),sa=e=>s.jsx("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M2 2h20v20h-20z"})}),na=e=>s.jsxs("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:[s.jsx("path",{d:"M17.026 22.957c10.957-11.421-2.326-20.865-10.384-13.309l2.464 2.352h-9.106v-8.947l2.232 2.229c14.794-13.203 31.51 7.051 14.794 17.675z"})," "]}),ra=e=>s.jsx("svg",{viewBox:"0 0 24 24",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M1.004 6.251l10.996-5.998 10.99 6.06-10.985 5.861-11.001-5.923zm11.996 7.676v9.82l10-5.362v-9.82l-10 5.362zm-2 0l-10-5.411v9.869l10 5.362v-9.82z"})}),aa=e=>s.jsx("svg",{viewBox:"0 0 512 512",width:"1rem",xmlns:"http://www.w3.org/2000/svg",...e,children:s.jsx("path",{d:"M507.73 109.1c-2.24-9.03-13.54-12.09-20.12-5.51l-74.36 74.36-67.88-11.31-11.31-67.88 74.36-74.36c6.62-6.62 3.43-17.9-5.66-20.16-47.38-11.74-99.55.91-136.58 37.93-39.64 39.64-50.55 97.1-34.05 147.2L18.74 402.76c-24.99 24.99-24.99 65.51 0 90.5 24.99 24.99 65.51 24.99 90.5 0l213.21-213.21c50.12 16.71 107.47 5.68 147.37-34.22 37.07-37.07 49.7-89.32 37.91-136.73zM64 472c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24z"})}),te=e=>e>=128?e-255-1:e,oa=e=>e<0?e+255+1:e,Js=e=>e.toString(2).padStart(8,"0"),ne=e=>e.toString(16).padStart(2,"0").toUpperCase(),ia=e=>Js(e).split("").map(Number),ca=(e,t,n)=>Math.min(Math.max(e,t),n),zs=e=>Number.parseInt(e,16),he=(e,t)=>{const n=[];t===void 0&&(t=e,e=0);for(let r=e;r<t;r++)n.push(r);return n},la=e=>e.split(/(?=[A-Z])/).join(" "),da=/^\[(.*)\]$/,Dt=e=>e.replace(da,"$1"),ua=/\\/g,pa=e=>e.replace(ua,"\\\\"),ha=/'/g,ga=e=>e.replace(ha,"\\'"),ma=/'.*'/,xa=e=>{var n;const t=(n=ma.exec(e))==null?void 0:n[0];return t===void 0?e:e.replace(t,`'${ga(t.slice(1,-1))}'`)},fa=e=>Ks(e.replace(/\\u/g,"u")),Ks=e=>{try{return JSON.parse(e)}catch(t){if(t instanceof SyntaxError){const n=Number(t.message.split(" ").slice(-1)[0]);if(e[n-1]==="\\")return Ks(e.slice(0,n-1)+e.slice(n))}throw t}},Ra=e=>e.split("").map(t=>t.charCodeAt(0)),nt=e=>Object.prototype.toString.call(e),ba=(e,t)=>nt(e)===nt(t),Ae=e=>nt(e)==="[object Object]",It=(e,t)=>e in t,Lt=(e,t)=>{const n=[],r=t.length;for(let a=0;a<r;a+=e)n.push(t.slice(a,a+e));return n},Ea=e=>e.map(t=>String.fromCharCode(t)),Sa=e=>typeof e=="function",At=e=>e(),ja=(e,t)=>(...n)=>e(...n.slice(0,t)),ge=e=>t=>n=>e(n,t),ya=(...e)=>t=>e.reduce((n,r)=>r(n),t),va=(e,t)=>{let n,r;return function a(...o){window.clearTimeout(r);const i=Date.now();n===void 0||i-n>=t?(e(...o),n=i):r=window.setTimeout(()=>{a(...o)},t-(i-n))}},Mt=e=>E.useReducer(t=>!t,e),Zs=e=>{const t=E.useRef(null);return t.current===null&&(t.current=Sa(e)?e():e),t.current},Me=()=>E.useState(null),_a=e=>{const t=E.useRef(null);return E.useInsertionEffect(()=>{t.current=e},[e]),E.useCallback((...n)=>{const r=t.current;return r(...n)},[])},Ct=e=>{const[t,n]=Me();return E.useEffect(()=>{if(t===null)return;const r=a=>{a.target instanceof Element&&a.target!==t&&!t.contains(a.target)&&e(a)};return document.addEventListener("click",r),()=>{document.removeEventListener("click",r)}},[t,e]),n},Ys=(e,t)=>{const[n,r]=Me(),a=Zs({isHovered:!1});return E.useEffect(()=>{if(n===null)return;const o=()=>{t===void 0?(e(!0),a.isHovered=!0):a.timeoutId=window.setTimeout(()=>{e(!0),a.isHovered=!0},t)},i=()=>{window.clearTimeout(a.timeoutId)},l=()=>{i(),e(!1),a.isHovered=!1};return n.addEventListener("mouseenter",o),n.addEventListener("mouseleave",l),()=>{n.removeEventListener("mouseenter",o),n.removeEventListener("mouseleave",l),i(),a.isHovered&&(e(!1),a.isHovered=!1)}},[n,t,e,a]),r},ns={error:null,source:"",addressToStatementMap:{}},Nt=Re({name:"assembler",initialState:ns,reducers:{setState:(e,t)=>{e.error=null,e.source=t.payload.source,e.addressToStatementMap=Object.freeze(t.payload.addressToStatementMap)},setError:(e,t)=>{e.error=t.payload,e.source="",e.addressToStatementMap={}},resetState:()=>ns},selectors:{selectAssembledSource:e=>e.source,selectAddressToStatementMap:e=>e.addressToStatementMap,selectAssemblerError:e=>e.error,selectAssemblerErrorRange:e=>{var t;return(t=e.error)==null?void 0:t.range}}}),{setState:Xs,setError:qs,resetState:Qs}=Nt.actions,{selectAssembledSource:wa,selectAddressToStatementMap:en,selectAssemblerError:Da,selectAssemblerErrorRange:Ia}=Nt.selectors;var rt=(e=>(e[e["2 Hz"]=2]="2 Hz",e[e["4 Hz"]=4]="4 Hz",e[e["8 Hz"]=8]="8 Hz",e[e["16 Hz"]=16]="16 Hz",e[e["32 Hz"]=32]="32 Hz",e[e["64 Hz"]=64]="64 Hz",e))(rt||{});const La=["2 Hz","4 Hz","8 Hz","16 Hz","32 Hz","64 Hz"];var at=(e=>(e[e["1 second"]=1e3]="1 second",e[e["2 seconds"]=2e3]="2 seconds",e[e["4 seconds"]=4e3]="4 seconds",e[e["8 seconds"]=8e3]="8 seconds",e))(at||{});const Aa=["1 second","2 seconds","4 seconds","8 seconds"],Ma={configuration:{autoAssemble:!0,clockSpeed:4,timerInterval:2e3,vimKeybindings:!1},isRunning:!1,isSuspended:!1},rs=ie.withTypes(),me=Re({name:"controller",initialState:Ma,reducers:{setAutoAssemble:(e,t)=>{e.configuration.autoAssemble=t.payload},setClockSpeed:(e,t)=>{e.configuration.clockSpeed=t.payload},setTimerInterval:(e,t)=>{e.configuration.timerInterval=t.payload},setVimKeybindings:(e,t)=>{e.configuration.vimKeybindings=t.payload},setRunning:(e,t)=>{e.isRunning=t.payload},setSuspended:(e,t)=>{e.isSuspended=t.payload}},selectors:{selectAutoAssemble:e=>e.configuration.autoAssemble,selectClockSpeed:e=>e.configuration.clockSpeed,selectTimerInterval:e=>e.configuration.timerInterval,selectRuntimeConfiguration:rs([e=>e.configuration.clockSpeed,e=>e.configuration.timerInterval],(e,t)=>({clockSpeed:e,timerInterval:t})),selectVimKeybindings:e=>e.configuration.vimKeybindings,selectIsRunning:e=>e.isRunning,selectIsSuspended:e=>e.isSuspended,selectToPersist:rs([e=>e.configuration],e=>({configuration:e}))}}),{setAutoAssemble:Ca,setClockSpeed:Na,setTimerInterval:ka,setVimKeybindings:Ta,setRunning:as,setSuspended:Ve}=me.actions,{selectAutoAssemble:ot,selectClockSpeed:Oa,selectTimerInterval:Ga,selectRuntimeConfiguration:it,selectVimKeybindings:tn,selectIsRunning:ye,selectIsSuspended:Ce}=me.selectors,je=" ",ct=250;var Le=(e=>(e[e.BS=8]="BS",e[e.TAB=9]="TAB",e[e.CR=13]="CR",e[e.Space=32]="Space",e))(Le||{}),v=(e=>(e.END="END",e.ADD="ADD",e.SUB="SUB",e.MUL="MUL",e.DIV="DIV",e.INC="INC",e.DEC="DEC",e.MOD="MOD",e.AND="AND",e.OR="OR",e.XOR="XOR",e.NOT="NOT",e.ROL="ROL",e.ROR="ROR",e.SHL="SHL",e.SHR="SHR",e.JMP="JMP",e.JZ="JZ",e.JNZ="JNZ",e.JS="JS",e.JNS="JNS",e.JO="JO",e.JNO="JNO",e.MOV="MOV",e.CMP="CMP",e.PUSH="PUSH",e.POP="POP",e.PUSHF="PUSHF",e.POPF="POPF",e.CALL="CALL",e.RET="RET",e.INT="INT",e.IRET="IRET",e.IN="IN",e.OUT="OUT",e.HALT="HALT",e.STI="STI",e.CLI="CLI",e.CLO="CLO",e.NOP="NOP",e.ORG="ORG",e.DB="DB",e))(v||{});const sn={END:0,ADD:2,SUB:2,MUL:2,DIV:2,INC:1,DEC:1,MOD:2,AND:2,OR:2,XOR:2,NOT:1,ROL:1,ROR:1,SHL:1,SHR:1,JMP:1,JZ:1,JNZ:1,JS:1,JNS:1,JO:1,JNO:1,MOV:2,CMP:2,PUSH:1,POP:1,PUSHF:0,POPF:0,CALL:1,RET:0,INT:1,IRET:0,IN:1,OUT:1,HALT:0,STI:0,CLI:0,CLO:0,NOP:0,ORG:1,DB:1};var p=(e=>(e[e.END=0]="END",e[e.ADD_REG_REG=160]="ADD_REG_REG",e[e.ADD_REG_INM=213]="ADD_REG_INM",e[e.ADD_REG_ADDR=214]="ADD_REG_ADDR",e[e.ADD_ADDR_REG=215]="ADD_ADDR_REG",e[e.ADD_REG_REGADDR=216]="ADD_REG_REGADDR",e[e.ADD_REGADDR_REG=217]="ADD_REGADDR_REG",e[e.SUB_REG_FROM_REG=161]="SUB_REG_FROM_REG",e[e.MUL_REG_BY_REG=162]="MUL_REG_BY_REG",e[e.DIV_REG_BY_REG=163]="DIV_REG_BY_REG",e[e.INC_REG=164]="INC_REG",e[e.DEC_REG=165]="DEC_REG",e[e.MOD_REG_BY_REG=166]="MOD_REG_BY_REG",e[e.AND_REG_WITH_REG=170]="AND_REG_WITH_REG",e[e.OR_REG_WITH_REG=171]="OR_REG_WITH_REG",e[e.XOR_REG_WITH_REG=172]="XOR_REG_WITH_REG",e[e.NOT_REG=173]="NOT_REG",e[e.ROL_REG=154]="ROL_REG",e[e.ROR_REG=155]="ROR_REG",e[e.SHL_REG=156]="SHL_REG",e[e.SHR_REG=157]="SHR_REG",e[e.SUB_IMM_FROM_REG=177]="SUB_IMM_FROM_REG",e[e.MUL_REG_BY_IMM=178]="MUL_REG_BY_IMM",e[e.DIV_REG_BY_IMM=179]="DIV_REG_BY_IMM",e[e.MOD_REG_BY_IMM=182]="MOD_REG_BY_IMM",e[e.AND_REG_WITH_IMM=186]="AND_REG_WITH_IMM",e[e.OR_REG_WITH_IMM=187]="OR_REG_WITH_IMM",e[e.XOR_REG_WITH_IMM=188]="XOR_REG_WITH_IMM",e[e.JMP=192]="JMP",e[e.JZ=193]="JZ",e[e.JNZ=194]="JNZ",e[e.JS=195]="JS",e[e.JNS=196]="JNS",e[e.JO=197]="JO",e[e.JNO=198]="JNO",e[e.MOV_REG_INM=208]="MOV_REG_INM",e[e.MOV_REG_ADDR=209]="MOV_REG_ADDR",e[e.MOV_ADDR_REG=210]="MOV_ADDR_REG",e[e.MOV_REG_REGADDR=211]="MOV_REG_REGADDR",e[e.MOV_REGADDR_REG=212]="MOV_REGADDR_REG",e[e.CMP_REG_WITH_REG=218]="CMP_REG_WITH_REG",e[e.CMP_REG_WITH_IMM=219]="CMP_REG_WITH_IMM",e[e.CMP_REG_WITH_VAL_FROM_ADDR=220]="CMP_REG_WITH_VAL_FROM_ADDR",e[e.PUSH_FROM_REG=224]="PUSH_FROM_REG",e[e.POP_TO_REG=225]="POP_TO_REG",e[e.PUSHF=234]="PUSHF",e[e.POPF=235]="POPF",e[e.CALL_ADDR=202]="CALL_ADDR",e[e.RET=203]="RET",e[e.INT_ADDR=204]="INT_ADDR",e[e.IRET=205]="IRET",e[e.IN_FROM_PORT_TO_AL=240]="IN_FROM_PORT_TO_AL",e[e.OUT_FROM_AL_TO_PORT=241]="OUT_FROM_AL_TO_PORT",e[e.HALT=0]="HALT",e[e.STI=252]="STI",e[e.CLI=253]="CLI",e[e.CLO=254]="CLO",e[e.NOP=255]="NOP",e))(p||{});const N=(...e)=>{let t="";const n=e.length;for(let r=0;r<n;r++){const a=e[r];if(a)if(typeof a=="string")t&&(t+=" "),t+=a;else for(const o in a)a[o]&&(t&&(t+=" "),t+=o)}return t},os=e=>{const t={},n=e.split(" "),r=n.length;for(let a=0;a<r;a++){const o=n[a];o&&(t[o]=!0)}return t},lt=(e,t)=>e?t?typeof e=="string"?lt(os(e),t):typeof t=="string"?lt(e,os(t)):N({...e,...t}):N(e):N(t),Ba="Invariant failed";function H(e,t=""){if(!e)throw new Error(Ba)}const nn=(e,t)=>{const n={},r=Object.getOwnPropertyNames(t),a=Object.getOwnPropertySymbols(t),o=Ae(e);if(o){const l=Object.getOwnPropertyNames(e),m=Object.getOwnPropertySymbols(e),R=d=>{const f=typeof d=="symbol";(!f&&!r.includes(d)||f&&!a.includes(d))&&Object.defineProperty(n,d,Object.getOwnPropertyDescriptor(e,d))};l.forEach(R),m.forEach(R)}const i=l=>{const m=t[l];if(o&&Ae(m)){const d=e[l];Object.defineProperty(n,l,{...Object.getOwnPropertyDescriptor(t,l),value:nn(d,m)})}else Object.defineProperty(n,l,Object.getOwnPropertyDescriptor(t,l))};return r.forEach(i),a.forEach(i),n},rn=(e,...t)=>t.reduce(nn,e),an=(e,t)=>{if(!ba(e,t))return e;if(!Ae(e)||!Ae(t))return t;const n={},r=Object.getOwnPropertyNames(e),a=Object.getOwnPropertySymbols(e),o=Object.getOwnPropertyNames(t),i=Object.getOwnPropertySymbols(t),l=R=>{const d=typeof R=="symbol";(!d&&!o.includes(R)||d&&!i.includes(R))&&Object.defineProperty(n,R,Object.getOwnPropertyDescriptor(e,R))};r.forEach(l),a.forEach(l);const m=R=>{const d=typeof R=="symbol";if(!d&&r.includes(R)||d&&a.includes(R)){const f=e[R],h=t[R];Object.defineProperty(n,R,{...Object.getOwnPropertyDescriptor(e,R),value:an(f,h)})}};return o.forEach(m),i.forEach(m),n},Pa=(e,...t)=>t.reduce(an,e),on=-1,Fa=15;var kt=(e=>(e[e.SimulatedKeyboard=0]="SimulatedKeyboard",e[e.Thermostat=3]="Thermostat",e[e.Keyboard=7]="Keyboard",e[e.NumericKeypad=8]="NumericKeypad",e))(kt||{});const Va={data:{content:null,port:null},interrupt:!1};var dt=(e=>(e[e.TrafficLights=1]="TrafficLights",e[e.SevenSegmentDisplay=2]="SevenSegmentDisplay",e[e.Heater=3]="Heater",e[e.SnakeInMaze=4]="SnakeInMaze",e[e.StepperMotor=5]="StepperMotor",e[e.Lift=6]="Lift",e[e.Keyboard=7]="Keyboard",e[e.NumericKeypad=8]="NumericKeypad",e))(dt||{});const Tt=191;var Te=(e=>(e.AL="AL",e.BL="BL",e.CL="CL",e.DL="DL",e))(Te||{}),W=(e=>(e[e.AL=0]="AL",e[e.BL=1]="BL",e[e.CL=2]="CL",e[e.DL=3]="DL",e))(W||{}),Ke=(e=>(e.IP="IP",e.SP="SP",e.SR="SR",e))(Ke||{});const Ha="__IS_ERROR_OBJECT",$e=({name:e,message:t,stack:n})=>({name:e,message:t,stack:n,[Ha]:!0});class Y extends Error{constructor(){super(...arguments);A(this,"name","RuntimeError")}toPlainObject(){return $e(this)}}class Ua extends Y{constructor(t){super(`Invalid register '${ne(t)}'.`)}}class $a extends Y{constructor(){super("Can not execute code beyond the end of RAM.")}}class Wa extends Y{constructor(){super("Stack overflow.")}}class Ja extends Y{constructor(){super("Stack underflow.")}}class za extends Y{constructor(){super("Can not divide by zero.")}}class Ka extends Y{constructor(t){super(`I/O ports between 0 and F are available, got '${ne(t)}'.`)}}class Za extends Y{constructor(t){super(`Input data '${ne(t)}' is greater than FF.`)}}class Ya extends Y{constructor(t){super(`Invalid opcode '${ne(t)}'.`)}}const Ie=(e,t)=>t+e,Se=(e,t)=>t-e,is=(e,t)=>t*e,cn=e=>{if(e===0)throw new za;return e},cs=(e,t)=>Math.floor(t/cn(e)),Xa=e=>Ie(1,e),qa=e=>Se(1,e),ls=(e,t)=>t%cn(e),ds=(e,t)=>t&e,us=(e,t)=>t|e,ps=(e,t)=>t^e,Qa=e=>~e,eo=e=>e<<1|e>>7,to=e=>e>>1|e<<7,so=e=>e<<1,no=e=>e>>1,ro=2,ln=(e,t)=>(e&t)===t,hs=e=>ln(e,16),ao=()=>({gpr:[0,0,0,0],ip:0,sp:Tt,sr:0}),y=e=>{if(e>W.DL)throw new Ua(e);return e},oo=e=>{if(e>255)throw new $a;return e},gs=e=>{if(e<0)throw new Wa;if(e>Tt)throw new Ja;return e},ms=e=>{if(e>Fa)throw new Ka(e);return e},io=e=>{if(e>255)throw new Za(e);return e},co=(e,t)=>{const n=()=>t.data,r=()=>t.interrupt,a={},o=()=>{a.halted=!0},i=()=>{a.closeWindows=!0},l=j=>{a.expectedInputPort=j},m=(j,C)=>{a.data={content:j,port:C}},R={input:t,output:a},d={},f=j=>{d.memoryData=j},h=(j,C)=>{d.cpuRegisters??(d.cpuRegisters={}),d.cpuRegisters[j]=C};return{...Rt(e,j=>{const{memoryData:C,cpuRegisters:D}=j,x=c=>C[c],Q=(c,b)=>{C[c]=b,f({address:c,value:b})},S=c=>D.gpr[c],w=(c,b)=>{D.gpr[c]=b,h("gpr",{name:W[c],value:b})},de=()=>D.ip,G=(c=1)=>D.ip+c,B=c=>{D.ip=c,h("ip",{value:c})},u=(c=1)=>(B(oo(D.ip+c)),D.ip),P=c=>{Q(D.sp,c);const b=gs(D.sp-1);D.sp=b,h("sp",{value:b})},z=()=>{const c=gs(D.sp+1);return D.sp=c,h("sp",{value:c}),x(D.sp)},Be=()=>D.sr,De=c=>{D.sr=c,h("sr",{value:D.sr})},ue=c=>ln(D.sr,c),Yt=c=>{const b=D.sr;D.sr=c?b|16:b&-17,h("sr",{interrupt:!0,value:D.sr})},L=(c,...b)=>{const $=c(...b);let Ee=0;const Qt=$<<24>>24;(Qt<-128||Qt>127)&&(Ee|=4),$>255||$<0?Ee|=1:Ee&=-2;const es=$>255?$%256:oa($);switch(!0){case es===0:Ee|=2;break;case es>=128:Ee|=8;break}const Qn=D.sr&16;return De(Ee|Qn),$&255},Xt=r()&&ue(16),qt=Xt?p.INT_ADDR:x(de());switch(qt){case p.END:case p.HALT:{o();break}case p.ADD_REG_REG:{const c=y(x(u())),b=y(x(u()));w(c,L(Ie,S(b),S(c))),u();break}case p.ADD_REG_INM:{const c=y(x(u())),b=x(u());w(c,L(Ie,b,S(c))),u();break}case p.ADD_REG_ADDR:{const c=y(x(u())),b=x(u());w(c,L(Ie,S(c),x(b))),u();break}case p.ADD_REG_REGADDR:{const c=y(x(u())),b=x(u());w(c,L(Ie,S(c),x(b))),u();break}case p.SUB_REG_FROM_REG:{const c=y(x(u())),b=y(x(u()));w(c,L(Se,S(b),S(c))),u();break}case p.MUL_REG_BY_REG:{const c=y(x(u())),b=y(x(u()));w(c,L(is,S(b),S(c))),u();break}case p.DIV_REG_BY_REG:{const c=y(x(u())),b=y(x(u()));w(c,L(cs,S(b),S(c))),u();break}case p.INC_REG:{const c=y(x(u()));w(c,L(Xa,S(c))),u();break}case p.DEC_REG:{const c=y(x(u()));w(c,L(qa,S(c))),u();break}case p.MOD_REG_BY_REG:{const c=y(x(u())),b=y(x(u()));w(c,L(ls,S(b),S(c))),u();break}case p.AND_REG_WITH_REG:{const c=y(x(u())),b=y(x(u()));w(c,L(ds,S(b),S(c))),u();break}case p.OR_REG_WITH_REG:{const c=y(x(u())),b=y(x(u()));w(c,L(us,S(b),S(c))),u();break}case p.XOR_REG_WITH_REG:{const c=y(x(u())),b=y(x(u()));w(c,L(ps,S(b),S(c))),u();break}case p.NOT_REG:{const c=y(x(u()));w(c,L(Qa,S(c))),u();break}case p.ROL_REG:{const c=y(x(u()));w(c,L(eo,S(c))),u();break}case p.ROR_REG:{const c=y(x(u()));w(c,L(to,S(c))),u();break}case p.SHL_REG:{const c=y(x(u()));w(c,L(so,S(c))),u();break}case p.SHR_REG:{const c=y(x(u()));w(c,L(no,S(c))),u();break}case p.SUB_IMM_FROM_REG:{const c=y(x(u())),b=x(u());w(c,L(Se,b,S(c))),u();break}case p.MUL_REG_BY_IMM:{const c=y(x(u())),b=x(u());w(c,L(is,b,S(c))),u();break}case p.DIV_REG_BY_IMM:{const c=y(x(u())),b=x(u());w(c,L(cs,b,S(c))),u();break}case p.MOD_REG_BY_IMM:{const c=y(x(u())),b=x(u());w(c,L(ls,b,S(c))),u();break}case p.AND_REG_WITH_IMM:{const c=y(x(u())),b=x(u());w(c,L(ds,b,S(c))),u();break}case p.OR_REG_WITH_IMM:{const c=y(x(u())),b=x(u());w(c,L(us,b,S(c))),u();break}case p.XOR_REG_WITH_IMM:{const c=y(x(u())),b=x(u());w(c,L(ps,b,S(c))),u();break}case p.JMP:{const c=te(x(G()));u(c);break}case p.JZ:{const c=te(x(G()));u(ue(2)?c:2);break}case p.JNZ:{const c=te(x(G()));u(ue(2)?2:c);break}case p.JS:{const c=te(x(G()));u(ue(8)?c:2);break}case p.JNS:{const c=te(x(G()));u(ue(8)?2:c);break}case p.JO:{const c=te(x(G()));u(ue(4)?c:2);break}case p.JNO:{const c=te(x(G()));u(ue(4)?2:c);break}case p.MOV_REG_INM:{const c=y(x(u())),b=x(u());w(c,b),u();break}case p.MOV_REG_ADDR:{const c=y(x(u())),b=x(u());w(c,x(b)),u();break}case p.MOV_ADDR_REG:{const c=x(u()),b=y(x(u()));Q(c,S(b)),u();break}case p.MOV_REG_REGADDR:{const c=y(x(u())),b=y(x(u())),$=S(b);w(c,x($)),u();break}case p.MOV_REGADDR_REG:{const c=y(x(u())),b=S(c),$=y(x(u()));Q(b,S($)),u();break}case p.CMP_REG_WITH_REG:{const c=y(x(u())),b=y(x(u()));L(Se,S(b),S(c)),u();break}case p.CMP_REG_WITH_IMM:{const c=y(x(u())),b=x(u());L(Se,b,S(c)),u();break}case p.CMP_REG_WITH_VAL_FROM_ADDR:{const c=y(x(u())),b=x(u());L(Se,x(b),S(c)),u();break}case p.PUSH_FROM_REG:{const c=y(x(u()));P(S(c)),u();break}case p.POP_TO_REG:{const c=y(x(u()));w(c,z()),u();break}case p.PUSHF:{P(Be()),u();break}case p.POPF:{De(z()),u();break}case p.CALL_ADDR:{const c=x(G());P(G(2)),B(c);break}case p.RET:{B(z());break}case p.INT_ADDR:{if(Xt){P(de()),B(x(ro));break}const c=x(G());P(G(2)),B(x(c));break}case p.IRET:{B(z());break}case p.IN_FROM_PORT_TO_AL:{const c=n(),b=ms(x(G()));if(c.content===null||c.port!==b){l(b);break}c.content!==on&&w(W.AL,io(c.content)),u(2);break}case p.OUT_FROM_AL_TO_PORT:{const c=S(W.AL),b=ms(x(u()));m(c,b),u();break}case p.STI:{Yt(!0),u();break}case p.CLI:{Yt(!1),u();break}case p.CLO:{i(),u();break}case p.NOP:{u();break}default:throw new Ya(qt)}}),signals:R,changes:d}},xs={status:{fault:null,halted:!1},registers:ao()},fs=ie.withTypes(),Ot=Re({name:"cpu",initialState:xs,reducers:{setFault:(e,t)=>{e.status.fault=t.payload},setHalted:e=>{e.status.halted=!0},setRegisters:(e,t)=>{e.registers=t.payload},resetState:()=>xs},selectors:{selectCpuStatus:e=>e.status,selectCpuFault:e=>e.status.fault,selectCpuRegisters:e=>e.registers,selectCpuGeneralPurposeRegister:fs([e=>e.registers.gpr,(e,t)=>t],(e,t)=>e[t]),selectCpuInstructionPointerRegister:e=>e.registers.ip,selectCpuStackPointerRegister:e=>e.registers.sp,selectCpuPointerRegisters:fs([e=>e.registers.ip,e=>e.registers.sp],(e,t)=>({ip:e,sp:t})),selectCpuStatusRegister:e=>e.registers.sr}}),{setFault:lo,setHalted:ut,setRegisters:uo,resetState:dn}=Ot.actions,{selectCpuStatus:po,selectCpuFault:ho,selectCpuRegisters:go,selectCpuGeneralPurposeRegister:Ze,selectCpuInstructionPointerRegister:un,selectCpuStackPointerRegister:mo,selectCpuPointerRegisters:xo,selectCpuStatusRegister:fo}=Ot.selectors,pt=(e,t)=>{const{from:n,to:r,number:a}=e.lineAt(t);return{from:n,to:r,number:a}},pn=(e,t)=>e.from===t.from&&e.to===t.to,Ro=(e,t)=>e.from<t.to&&e.to>t.from,Rs=(e,t)=>t.some(n=>!n.empty&&n.from<e.to&&n.to>e.from),bo=`; --------------------------------------
;	Hardware Interrupts
; --------------------------------------
	JMP	 Start		; Jump past the table of interrupt vectors
	DB   50			; Vector at 02 pointing to address 50
Start:
	STI				; Set I flag. Enable hardware interrupts
	MOV	 AL,  30	; ASCII for '0'
Loop:
	MOV [C0], AL	; Copy the data in AL to the video RAM
	INC	 AL			; Add one to AL
	JMP	Loop
; --------------------------------------
	ORG	 50
	MOV  AL,  30	; Reset AL to ASCII for '0'
	IRET
; --------------------------------------
	END
; --------------------------------------

For more examples, select File > Open Example.
`,Eo=`; --------------------------------------
;	Keyboard Input
; --------------------------------------
	MOV  BL, C0		; Make BL point to video RAM
Loop:
	IN   00			; Wait for keyboard input
	CMP  AL, 0D		; Check if the key was Enter (Carriage Return)
	JZ  Done
	MOV [BL], AL	; Copy the data in AL to the video RAM that BL points to
	INC  BL			; Make BL point to the next video RAM location
	JNZ Loop
Done:
; --------------------------------------
	END
; --------------------------------------

For more examples, select File > Open Example.
`,So=`; --------------------------------------
;	Procedures
; --------------------------------------
	MOV  AL, E0		; 1110 0000
Loop:
	NOT  AL			; Invert the bits in AL
	OUT  01			; Send data to traffic lights
	MOV  BL, 01		; Short delay
	CALL 30			; Call procedure 30

	NOT  AL			; Invert the bits in AL
	OUT  01			; Send data to traffic lights
	MOV  BL, 04		; Middle sized delay
	CALL 30			; Call procedure 30

	NOT  AL			; Invert the bits in AL
	OUT  01			; Send data to traffic lights
	MOV  BL, 08		; Longer delay
	CALL 30			; Call procedure 30
	JMP  Loop
; --------------------------------------
	ORG  30
Rep:
	DEC  BL			; Subtract one from BL
	JNZ  Rep
	RET
; --------------------------------------
	END
; --------------------------------------

For more examples, select File > Open Example.
`,jo=`; --------------------------------------
;	Programa simple
; --------------------------------------
	JMP Start		; saltar a start
x:	DB  4           ; x=4
y:	DB  5           ; y=5
z:	DB  0           ; z=0

Start:
	MOV  AL, [2]	; cargo x
	ADD  AL, [3]	; x + y
	MOV [4], AL
; --------------------------------------
    END
; --------------------------------------
`,yo=`; --------------------------------------
;	Seven-segment Display
; --------------------------------------
	JMP Start		; Jump past the data table
	DB  FA			; 0 - 1111 1010
	DB  60			; 1 - 0110 0000
	DB  B6			; 2 - 1011 0110
	DB  9E			; 3 - 1001 1110
	DB  4E			; 4 - 0100 1110
	DB  DC			; 5 - 1101 1100
	DB  FC			; 6 - 1111 1100
	DB  8A			; 7 - 1000 1010
	DB  FE			; 8 - 1111 1110
	DB  DE			; 9 - 1101 1110
	DB  00
Start:
	MOV BL,  02		; Make BL point to the first entry in the data table
	MOV AL, [BL]	; Copy data from table to AL
Loop:
	OUT 02			; Send data to seven-segment display
	INC AL			; Set the right most bit to one
	NOP NOP NOP		; Wait for three cycles
	OUT 02			; Send data to seven-segment display
	INC BL			; Make BL point to the next entry in the data table
	MOV AL, [BL]	; Copy data from table to AL
	CMP AL,  00		; Check if the next entry exists
	JNZ Loop
	JMP Start
; --------------------------------------
	END
; --------------------------------------

For more examples, select File > Open Example.
`,vo=`; --------------------------------------
;	Software Interrupts
; --------------------------------------
	JMP Start		; Jump past the table of interrupt vectors
	DB   51			; Vector at 02 pointing to address 51
	DB   71			; Vector at 03 pointing to address 71
Start:
	INT  02			; Do interrupt 02
	INT  03			; Do interrupt 03
	JMP Start
; --------------------------------------
	ORG  50
	DB   E0
					; Interrupt code starts here
	MOV  AL, [50]	; Copy bits from RAM into AL
	NOT  AL			; Invert the bits in AL
	MOV [50], AL	; Copy inverted bits back to RAM
	OUT  01			; Send data to traffic lights
	IRET
; --------------------------------------
	ORG  70
	DB   FE
					; Interrupt code starts here
	MOV  AL, [70]	; Copy bits from RAM into AL
	NOT  AL			; Invert the bits in AL
	AND  AL,  FE	; Set the right most bit to zero
	MOV [70], AL	; Copy inverted bits back to RAM
	OUT  02			; Send data to seven-segment display
	IRET
; --------------------------------------
	END
; --------------------------------------

For more examples, select File > Open Example.
`,bs=`; --------------------------------------
;	Untitled
; --------------------------------------
	
; --------------------------------------
	END
; --------------------------------------
`,_o=`; --------------------------------------
;	Traffic Lights
; --------------------------------------
	MOV AL, 80		; 1000 0000
Loop:
	OUT 01			; Send data to traffic lights
	ROR AL			; Rotate the bits in AL to the right
	JMP Loop
; --------------------------------------
	END
; --------------------------------------

For more examples, select File > Open Example.
`,wo=`; --------------------------------------
;	Visual Display Unit
; --------------------------------------
	JMP Start		; Jump past the data table
	DB  "Hello World!"
	DB   00
Start:
	MOV  AL,  C0	; Make AL point to video RAM
	MOV  BL,  02	; Make BL point to the first character in the string
	MOV  CL, [BL]	; Copy the data from RAM into CL
Loop:
	MOV [AL], CL	; Copy the data in CL to the video RAM that AL points to
	INC  AL			; Make AL point to the next video RAM location
	INC  BL			; Make BL point to the next character in the string
	MOV  CL, [BL]	; Copy the data from RAM into CL
	CMP  CL,  00	; Check if the next character exists
	JNZ Loop
; --------------------------------------
	END
; --------------------------------------

For more examples, select File > Open Example.
`,Do=/;\t(.*)/,hn=e=>Do.exec(e)[1],Gt={title:hn(bs),content:bs},Io=e=>e===Gt.content,Lo=(()=>{const{title:e,content:t}=Gt,n=t.indexOf(e);return{anchor:n,head:n+e.length}})(),gn=[jo,So,vo,bo,Eo,wo,_o,yo].map(e=>({title:hn(e),content:e}));var re=(e=>(e[e.Info=0]="Info",e[e.Warning=1]="Warning",e[e.Error=2]="Error",e))(re||{});const Ao={input:gn[4].content,breakpoints:[],message:null},Mo=ie.withTypes(),xe=Re({name:"editor",initialState:Ao,reducers:{setInput:{reducer:(e,t)=>{e.input=t.payload.value},prepare:e=>{const{value:t,isFromFile:n=!1}=e;return{payload:{value:t,isFromFile:n}}}},setBreakpoints:(e,t)=>{e.breakpoints=t.payload},addBreakpoint:(e,t)=>{const n=t.payload,r=e.breakpoints.findIndex(a=>a.from>n.from);r===-1?e.breakpoints.push(n):e.breakpoints.splice(r,0,n)},removeBreakpoint:(e,t)=>{const n=t.payload,r=e.breakpoints.findIndex(a=>pn(a,n));e.breakpoints.splice(r,1)},setMessage:(e,t)=>{e.message=t.payload},clearMessage:e=>{e.message=null}},selectors:{selectEditorInput:e=>e.input,selectEditorBreakpoints:e=>e.breakpoints,selectEditorMessage:e=>e.message,selectToPersist:Mo([e=>e.input,e=>e.breakpoints],(e,t)=>({input:e,breakpoints:t}))}}),{setInput:be,setBreakpoints:mn,addBreakpoint:Co,removeBreakpoint:No,setMessage:ht,clearMessage:gt}=xe.actions,{selectEditorInput:We,selectEditorBreakpoints:xn,selectEditorMessage:mt}=xe.selectors,ko=null,Bt=Re({name:"exception",initialState:ko,reducers:{set:{reducer:(e,t)=>t.payload,prepare:e=>{if(e instanceof Error)return{payload:$e(e)};{const t=new Error(`Uncaught ${JSON.stringify(e)}`);return{payload:$e(t)}}}},clear:()=>null},selectors:{selectException:e=>e}}),{set:ve,clear:To}=Bt.actions,{selectException:Oo}=Bt.selectors,fn=256,Oe=192,Rn=()=>new Array(fn-Oe).fill(Le.Space),bn=()=>new Array(Oe).fill(0).concat(Rn()),Go=e=>{const t=bn();for(const n in e)t[n]=e[n];return t},Bo=e=>e.slice(Oe),Po=e=>{const t=[];for(let n=0;n<fn;n++)t.push(n<Oe?v.END:"");for(const n in e){const r=e[n];if(r===void 0)continue;const{instruction:a,operands:o}=r;if(a.mnemonic===v.DB){const i=o[0];typeof i.code=="number"?t[n]=i.value:i.value.split("").forEach((l,m)=>{t[Number(n)+m]=l})}else{t[n]=a.mnemonic;const i=Number(n)+1;o.forEach((l,m)=>{const{value:R}=l,d=l.type.endsWith("Address");t[i+m]=d?`[${R}]`:R})}}return t};var fe=(e=>(e.VisualDisplayUnit="VisualDisplayUnit",e.TrafficLights="TrafficLights",e.SevenSegmentDisplay="Seven-segmentDisplay",e))(fe||{});const En=Object.values(fe),Fo=Rn(),Es=new Array(8).fill(0),Ss={inputSignals:Va,isWaitingForInput:!1,isWaitingForKeyboardInput:!1,devices:{VisualDisplayUnit:{data:Fo,isVisible:!0},TrafficLights:{data:Es,isVisible:!1},"Seven-segmentDisplay":{data:Es,isVisible:!1}}},Pt=Re({name:"io",initialState:Ss,reducers:{setInputData:(e,t)=>{const{content:n,port:r}=t.payload;e.inputSignals.data.content=n,e.inputSignals.data.port=r},clearInputData:e=>{e.inputSignals.data.content=null,e.inputSignals.data.port=null},setInterrupt:(e,t)=>{e.inputSignals.interrupt=t.payload},setWaitingForInput:(e,t)=>{e.isWaitingForInput=t.payload},setWaitingForKeyboardInput:(e,t)=>{e.isWaitingForKeyboardInput=t.payload},setVduDataFrom:(e,t)=>{const n=t.payload;e.devices.VisualDisplayUnit.data=Bo(n)},setDeviceData:(e,t)=>{const{name:n,data:r}=t.payload;e.devices[n].data=ia(r)},toggleDeviceVisible:(e,t)=>{const n=t.payload;e.devices[n].isVisible=!e.devices[n].isVisible},setDevicesInvisible:e=>{En.forEach(t=>{e.devices[t].isVisible=!1})},resetState:e=>rn(Ss,{devices:Object.entries(e.devices).reduce((t,[n,{isVisible:r}])=>Object.assign(t,{[n]:{isVisible:r}}),{})})},selectors:{selectInputSignals:e=>e.inputSignals,selectIsWaitingForInput:e=>e.isWaitingForInput,selectIsWaitingForKeyboardInput:e=>e.isWaitingForKeyboardInput,selectIoDeviceStates:e=>e.devices,selectIoDeviceData:(e,t)=>e.devices[t].data,selectIoDeviceVisibility:(e,t)=>e.devices[t].isVisible}}),{setInputData:Vo,clearInputData:js,setInterrupt:et,setWaitingForInput:ys,setWaitingForKeyboardInput:Sn,setVduDataFrom:jn,setDeviceData:yn,toggleDeviceVisible:vn,setDevicesInvisible:Ho,resetState:_n}=Pt.actions,{selectInputSignals:Uo,selectIsWaitingForInput:$o,selectIsWaitingForKeyboardInput:Wo,selectIoDeviceStates:Jo,selectIoDeviceData:zo,selectIoDeviceVisibility:Ko}=Pt.selectors;var Je=(e=>(e.Hexadecimal="Hexadecimal",e.Decimal="Decimal",e.Source="Source",e))(Je||{});const Zo=Object.values(Je),wn=bn(),Yo={data:wn,view:"Hexadecimal"},Xo=ie.withTypes(),Ft=Re({name:"memory",initialState:Yo,reducers:{initDataFrom:(e,t)=>{e.data=Go(t.payload)},setData:(e,t)=>{e.data=t.payload},resetData:e=>{e.data=wn},setView:(e,t)=>{e.view=t.payload}},selectors:{selectMemoryData:e=>e.data,selectMemoryDataRows:Xo([e=>e.data],e=>()=>Lt(16,e)),selectMemoryView:e=>e.view}}),{initDataFrom:Dn,setData:qo,resetData:In,setView:Qo}=Ft.actions,{selectMemoryData:Vt,selectMemoryDataRows:ei,selectMemoryView:Ln}=Ft.selectors,Ye=e=>t=>(...n)=>{const r=t(...n);return{...r,...e(r)}},ti=Ye(e=>({getState:function(n){const r=e.getState();return n?n(r):r}})),si=Ye(e=>{const t=Symbol("NIL");let n=t;return{dispatch:o=>{H(n===t);try{return n=e.getState(),e.dispatch(o)}finally{n=t}},subscribeChange:o=>e.subscribe(()=>{H(n!==t),e.getState()!==n&&o()})}}),An=e=>{const t=new WeakMap;return n=>(t.has(n)||t.set(n,e(n)),t.get(n))},ni=e=>t=>t.type===e.type,ri=e=>e.payload,ai=()=>{const e=new sr,t=()=>a=>o=>{const i=a(o);return nr(o)&&e.next(o),i},n=An(a=>e.pipe(U(ni(a)),k(ri))),r=Ye(()=>({onAction:n}));return{middleware:t,enhancer:r}},oi=()=>{const e=Symbol("NIL"),t=new rr(e),n=t.pipe(k(i=>(H(i!==e),i)),ts()),r=i=>(t.next(i.getState()),l=>m=>{const R=l(m);return t.next(i.getState()),R}),a=An(i=>n.pipe(k(i),ts())),o=Ye(()=>({onState:a}));return{middleware:r,enhancer:o}},ii="sim-x86",vs=`persist:${ii}`,ci=(e,t)=>({read:()=>{try{const n=localStorage.getItem(vs);if(n!==null){const r=JSON.parse(n);if(e(r))return r}}catch{}return t},write:n=>{try{const r=JSON.stringify(n);localStorage.setItem(vs,r)}catch{}}}),Mn="shareable",li=e=>{const t=new URL(window.location.href),n=ir(JSON.stringify(e)),r=cr(n,!0);return t.searchParams.set(Mn,r),t},di=(e,t)=>({read:()=>{const r=new URL(window.location.href).searchParams.get(Mn);if(r!==null)try{const a=ar(r),o=or(a,{to:"string"}),i=JSON.parse(o);if(e(i))return i}catch{}return t},write:n=>{const r=li(n);window.history.replaceState({},"",r)}}),ui=[ci,di],pi=(e,t=ui)=>(n,r)=>{const a=t.map(o=>o(n,r));return{read:()=>a.map(o=>o.read()).reduce(e),write:o=>a.forEach(i=>i.write(o))}},Cn=pi(ja(rn,2))(Ae,{}),hi=()=>{const e=Cn.read();return Pa({[xe.reducerPath]:xe.getInitialState(),[me.reducerPath]:me.getInitialState()},e)},gi=ie(xe.selectors.selectToPersist,me.selectors.selectToPersist,(e,t)=>({[xe.reducerPath]:e,[me.reducerPath]:t})),mi=Cn.write,_s=Symbol("NIL");function xi(e,t,n,r){const a=E.useRef(_s),o=E.useMemo(()=>{let l=!1,m,R;const d=h=>{if(!l){l=!0,m=h;const D=n(h),x=a.current;return x!==_s&&r(x,D)?(R=x,x):(R=D,D)}const _=m,j=R;if(Object.is(_,h))return j;const C=n(h);return r(j,C)?(m=h,j):(m=h,R=C,C)};return()=>d(t())},[t,n,r]),i=E.useSyncExternalStore(e,o);return E.useEffect(()=>{a.current=i},[i]),E.useDebugValue(i),i}const fi=(e,t)=>e===t,I=(e,t=fi)=>{const n=xi(g.subscribeChange,g.getState,e,t);return E.useDebugValue(n),n},Ri=lr(xe,Nt,me,Ft,Ot,Pt,Bt),ws=oi(),Ds=ai(),g=dr({reducer:Ri,middleware:e=>e().concat(Ds.middleware,ws.middleware),devTools:!1,preloadedState:hi(),enhancers:e=>e({autoBatch:!1}).concat(Ds.enhancer,ws.enhancer).concat(ti).concat(si)});g.onState(gi).subscribe(mi);const Nn=E.createContext({currentOpen:null,setCurrentOpen:()=>{throw new Error("MenuContext not initialized")}}),Xe=({children:e})=>{const[t,n]=Me(),r=t!==null,{currentOpen:a,setCurrentOpen:o}=E.useContext(Nn),i=a!==null&&a===t,l=()=>{o(i?null:t)},m=E.useCallback(d=>{a!==null&&a!==t&&d&&o(t)},[a,t,o]),R=Ys(m);return s.jsx("div",{ref:n,className:N("flex items-center hover:bg-gray-200",{"bg-gray-200":i}),onClick:l,children:r&&e(i,R,t)})},kn="flex h-full space-x-2 items-center",bi=({children:e})=>s.jsx("div",{className:kn,children:e}),Ei=({innerRef:e,children:t})=>s.jsx("div",{ref:e,className:N(kn,"py-1 px-2 hover:active:bg-gray-300"),children:t}),M=Object.assign(bi,{Main:Ei}),Ht="flex space-x-4 py-1 px-2 items-center justify-between hover:bg-gray-200",Si=({onClick:e,children:t})=>s.jsxs("div",{className:Ht,onClick:e,children:[t,s.jsx("span",{className:"w-4"})]}),ji=({href:e,children:t})=>s.jsxs(se,{className:Ht,href:e,children:[t,s.jsx("div",{className:"w-4",children:s.jsx(ea,{className:"mx-auto fill-gray-400",width:"0.875rem"})})]}),yi=({children:e})=>{const[t,n]=Me(),r=t!==null,[a,o]=E.useState(!1),i=Ys(o,100),l=f=>{n(f),i(f)},[m,R]=Me(),d=f=>{H(f.target instanceof Node),(m===null||!m.contains(f.target))&&f.stopPropagation()};return s.jsx("div",{ref:l,className:Ht,onClick:d,children:r&&s.jsxs(s.Fragment,{children:[s.jsx("div",{children:e(a,R,t)}),s.jsx("div",{className:"w-4",children:s.jsx(Ws,{className:"mx-auto",width:"0.625rem"})})]})})},O=Object.assign(Si,{ExternalLink:ji,Expandable:yi}),Tn=1,On="divide-y border bg-gray-50 shadow fixed",vi=({menuElement:e,children:t})=>{const n=r=>{if(r===null)return;const{bottom:a,left:o}=e.getBoundingClientRect();r.style.top=`${a-Tn}px`,r.style.left=`${o}px`};return s.jsx("div",{ref:n,className:On,children:t})},_i=({innerRef:e,menuItemElement:t,children:n})=>{const r=a=>{if(e(a),a===null)return;const{top:o,right:i}=t.getBoundingClientRect(),l=t.offsetTop===0;a.style.top=`${o-(l?Tn:0)}px`,a.style.left=`${i}px`};return s.jsx("div",{ref:r,className:On,children:n})},X=Object.assign(vi,{Expanded:_i}),wi=()=>{const e=I(ot),t=()=>{g.dispatch(Ca(!e))};return s.jsx(O,{onClick:t,children:s.jsxs(M,{children:[e?s.jsx(we,{}):s.jsx("span",{className:"w-4"}),s.jsx("span",{children:"Auto Assemble"})]})})},Di=()=>{const e=I(Oa);return s.jsx(O.Expandable,{children:(t,n,r)=>s.jsxs(s.Fragment,{children:[s.jsxs(M,{children:[s.jsx("span",{className:"w-4"}),s.jsx("span",{children:"Clock Speed"})]}),t&&s.jsx(X.Expanded,{innerRef:n,menuItemElement:r,children:La.map((a,o)=>s.jsx(O,{onClick:()=>{g.dispatch(Na(rt[a]))},children:s.jsxs(M,{children:[e===rt[a]?s.jsx(we,{}):s.jsx("span",{className:"w-4"}),s.jsx("span",{children:a})]})},o))})]})})},Ii=()=>{const e=I(Ga);return s.jsx(O.Expandable,{children:(t,n,r)=>s.jsxs(s.Fragment,{children:[s.jsxs(M,{children:[s.jsx("span",{className:"w-4"}),s.jsx("span",{children:"Timer Interval"})]}),t&&s.jsx(X.Expanded,{innerRef:n,menuItemElement:r,children:Aa.map((a,o)=>s.jsx(O,{onClick:()=>{g.dispatch(ka(at[a]))},children:s.jsxs(M,{children:[e===at[a]?s.jsx(we,{}):s.jsx("span",{className:"w-4"}),s.jsx("span",{children:a})]})},o))})]})})},Li=()=>{const e=I(tn),t=()=>{g.dispatch(Ta(!e))};return s.jsx(O,{onClick:t,children:s.jsxs(M,{children:[e?s.jsx(we,{}):s.jsx("span",{className:"w-4"}),s.jsx("span",{children:"Vim Keybindings"})]})})},Ai=()=>s.jsx(Xe,{children:(e,t,n)=>s.jsxs(s.Fragment,{children:[s.jsxs(M.Main,{innerRef:t,children:[s.jsx(aa,{}),s.jsx("span",{children:"Configuration"})]}),e&&s.jsxs(X,{menuElement:n,children:[s.jsx(wi,{}),s.jsx(Di,{}),s.jsx(Ii,{}),s.jsx(Li,{})]})]})}),T=(e,t)=>{const n=e.subscribe(t);return()=>n.unsubscribe()},ze=class ze extends Error{constructor(n,r){super(ze.escape(n));A(this,"range");this.range=r}toPlainObject(){return{...$e(this),range:this.range}}};A(ze,"escape",ya(pa,xa));let _e=ze;class Ge extends _e{constructor(){super(...arguments);A(this,"name","TokenizeError")}}class Mi extends Ge{constructor(t,n){super(`Unterminated address '${t}'.`,n)}}class Ci extends Ge{constructor(t,n){super(`Unterminated string '${t}'.`,n)}}class Ni extends Ge{constructor(t){super("Single quote is not allowed.",t)}}class ki extends Ge{constructor(t,n){super(`Unexpected character '${t}'.`,n)}}class Gn extends Ge{constructor(){super("Unexpected end of token stream.")}}class ce extends _e{constructor(){super(...arguments);A(this,"name","ParseError")}}class Ti extends ce{constructor({source:t,range:n},r){super(`Expected ${r?"":"label or "}instruction, got '${t}'.`,n)}}class Oi extends ce{constructor({source:t,range:n}){const r=t.replace(/:$/,"");super(`Label should contain only letter or underscore, got '${r}'.`,n)}}class Is extends ce{constructor(){super("Expected END at the end of the source code.")}}class Gi extends ce{constructor({source:t,range:n}){const r=Dt(t).trim();super(`Number '${r}' is greater than FF.`,n)}}class Bi extends ce{constructor({value:t,range:n},r){super(`UTF-16 code of character '${t[r]}' is greater than FF.`,n)}}class Pi extends ce{constructor({source:t,range:{from:n,to:r}}){const a=Dt(t).trim(),o={from:n+1,to:r-Math.min(1,a.length)};super(`Expected number or register, got '${a||"]"}'.`,o)}}class Fi extends ce{constructor({source:t,range:n},r){const a=r.map(o=>o.replace(/[A-Z]/g,i=>` ${i.toLowerCase()}`).trimStart()).reduce((o,i,l)=>{switch(l){case 0:return i;case r.length-1:return`${o} or ${i}`;default:return`${o}, ${i}`}},"");super(`Expected ${a}, got '${t}'.`,n)}}class Vi extends ce{constructor({source:t,range:n}){super(`Expected comma, got '${t}'.`,n)}}class Bn extends _e{constructor(){super(...arguments);A(this,"name","AssembleError")}}class Hi extends Bn{constructor({identifier:t,range:n}){super(`Duplicate label '${t}'.`,n)}}class Ui extends Bn{constructor({range:t}){super("Can not generate code beyond the end of RAM.",t)}}class $i extends Error{constructor(t,n){super(t),this.range=n,this.name="OperandError"}}class Wi extends $i{constructor(t){super(`Label '${t.value}' does not exist.`,t.range)}}var K=(e=>(e.Whitespace="Whitespace",e.Comment="Comment",e.Colon="Colon",e.Comma="Comma",e.Digits="Digits",e.Register="Register",e.Address="Address",e.String="String",e.Unknown="Unknown",e))(K||{});const Pn=[{type:"Whitespace",pattern:/\s+/},{type:"Comment",pattern:/;.*/},{type:"Colon",pattern:/:/},{type:"Comma",pattern:/,/},{type:"Digits",pattern:/\d+\b/},{type:"Register",pattern:/[a-dA-D][lL]\b/},{type:"Address",pattern:/\[.*?\]/},{type:"String",pattern:/"(?:[^\\\r\n]|\\.)*?"/},{type:"Unknown",pattern:/\w+/}],Ji=Pn.map(({pattern:e})=>`(${e.source})`).join("|"),zi=()=>new RegExp(Ji,"y"),Ki=(e,t,n)=>{const r=At(()=>{switch(e){case"Register":case"Unknown":return t.toUpperCase();case"Address":return Dt(t).trim().toUpperCase();case"String":return fa(t);default:return t}}),a=n,o=a+t.length;return{type:e,value:r,source:t,range:{from:a,to:o}}},Zi=e=>e.type==="Whitespace"||e.type==="Comment",Yi=e=>{const t=zi();return{next:()=>{const n=t.lastIndex,r=t.exec(e);if(r)for(let i=0;;i++){const l=r[i+1];if(l){const{type:m}=Pn[i];return Ki(m,l,n)}}if(t.lastIndex=n,n===e.length)return null;const a={from:n,to:n+1},o=e[n];switch(o){case"[":{const[i]=e.slice(n).match(/^\[\s*\w*/);throw a.to+=i.length-1,new Mi(i,a)}case'"':{const[i]=e.slice(n).match(/^".*/);throw a.to+=i.length-1,new Ci(i,a)}case"'":throw new Ni(a)}throw new ki(o,a)}}},Xi=e=>{const t=Yi(e),n=()=>{let l=null;do l=t.next();while(l&&Zi(l));return l};let r=n(),a=n();const o=()=>{if(!r)throw new Gn;return r},i={hasMore:()=>!!r,peek:()=>r,peekNext:()=>a,advance:()=>{r=a,a=n()},consume:()=>{const l=o();return i.advance(),l},match:l=>o().type!==l?!1:(i.advance(),!0)};return i},qi=({value:e,range:t})=>({identifier:e,range:t}),Qi=({value:e,range:t})=>({mnemonic:e,opcode:void 0,range:t});var Ut=(e=>(e.Number="Number",e.Register="Register",e.Address="Address",e.RegisterAddress="RegisterAddress",e.String="String",e.Label="Label",e))(Ut||{});const pe=(e,t)=>{const n=At(()=>{switch(e){case"Number":case"Address":return zs(t.value);case"Register":case"RegisterAddress":return H(It(t.value,W)),W[t.value];case"String":return Ra(t.value);case"Label":return}});return{...t,type:e,code:n}},ec=(e,t,n)=>{H(t.opcode!==void 0);const r=[];t.opcode!==null&&r.push(t.opcode),n.forEach(l=>{l.code!==void 0&&(typeof l.code=="number"?r.push(l.code):r.push(...l.code))});const a=t.range.from,i=(n.length>0?n[n.length-1]:t).range.to;return{label:e,instruction:t,operands:n,codes:r,range:{from:a,to:i}}},tc=/^[A-Z_]+$/,Fn=e=>{if(!tc.test(e.value))throw new Oi(e);return e},sc=e=>{const t=e.peekNext();if((t==null?void 0:t.type)!==K.Colon||t.range.from!==e.peek().range.to)return null;const n=e.consume(),r=qi(Fn(n));return e.advance(),r},tt=e=>{if(zs(e.value)>255)throw new Gi(e);return e},nc=e=>{const t=e.value.length;for(let n=0;n<t;n++)if(e.value.charCodeAt(n)>255)throw new Bi(e,n);return e},Ls=/^[\dA-F]+$/,rc=/^[A-D]L$/,xt=e=>(...t)=>{const n=e.consume();let r;const a=o=>t.includes(o);switch(n.type){case K.Digits:if(a(r="Number"))return pe(r,tt(n));break;case K.Register:if(a(r="Register"))return pe(r,n);break;case K.Address:if(a("Address")||a("RegisterAddress")){if(a(r="Address")&&Ls.test(n.value))return pe(r,tt(n));if(a(r="RegisterAddress")&&rc.test(n.value))return pe(r,n);throw new Pi(n)}break;case K.String:if(a(r="String"))return pe(r,nc(n));break;case K.Unknown:switch(!0){case a(r="Number"):if(Ls.test(n.value))return pe(r,tt(n));break;case a(r="Label"):return pe(r,Fn(n))}break}throw new Fi(n,t)},ac=e=>t=>{const n=[];t.forEach(([i])=>{n.includes(i)||n.push(i)});const r=xt(e)(...n);if(!e.match(K.Comma))throw new Vi(e.peek());const a=[];t.forEach(([i,l])=>{i===r.type&&a.push(l)});const o=xt(e)(...a);return[r,o]},oc=e=>{const t=sc(e),n=t!==null,r=e.consume();if(r.type!==K.Unknown||!It(r.value,v))throw new Ti(r,n);const a=Qi(r),o=d=>{a.opcode=d},i=[],l=(...d)=>{i.push(...d)},m=r.value;switch(sn[m]){case 0:{o(p[m]);break}case 1:{let d,f;const h=xt(e);switch(m){case v.INC:f=h("Register"),d=p.INC_REG;break;case v.DEC:f=h("Register"),d=p.DEC_REG;break;case v.NOT:f=h("Register"),d=p.NOT_REG;break;case v.ROL:f=h("Register"),d=p.ROL_REG;break;case v.ROR:f=h("Register"),d=p.ROR_REG;break;case v.SHL:f=h("Register"),d=p.SHL_REG;break;case v.SHR:f=h("Register"),d=p.SHR_REG;break;case v.JMP:f=h("Label"),d=p.JMP;break;case v.JZ:f=h("Label"),d=p.JZ;break;case v.JNZ:f=h("Label"),d=p.JNZ;break;case v.JS:f=h("Label"),d=p.JS;break;case v.JNS:f=h("Label"),d=p.JNS;break;case v.JO:f=h("Label"),d=p.JO;break;case v.JNO:f=h("Label"),d=p.JNO;break;case v.PUSH:f=h("Register"),d=p.PUSH_FROM_REG;break;case v.POP:f=h("Register"),d=p.POP_TO_REG;break;case v.CALL:f=h("Number"),d=p.CALL_ADDR;break;case v.INT:f=h("Number"),d=p.INT_ADDR;break;case v.IN:f=h("Number"),d=p.IN_FROM_PORT_TO_AL;break;case v.OUT:f=h("Number"),d=p.OUT_FROM_AL_TO_PORT;break;case v.ORG:f=h("Number"),d=null;break;case v.DB:f=h("Number","String"),d=null;break}o(d),l(f);break}case 2:{let d,f,h;const _=ac(e);switch(m){case v.ADD:switch([f,h]=_([["Register","Register"],["Register","Number"],["Register","Address"],["Register","RegisterAddress"],["Address","Register"],["RegisterAddress","Register"]]),f.type){case"Register":switch(h.type){case"Register":d=p.ADD_REG_REG;break;case"Number":d=p.ADD_REG_INM;break;case"Address":d=p.ADD_REG_ADDR;break;case"RegisterAddress":d=p.ADD_REG_REGADDR;break}break;case"Address":d=p.ADD_ADDR_REG;break;case"RegisterAddress":d=p.ADD_REGADDR_REG}break;case v.SUB:switch([f,h]=_([["Register","Register"],["Register","Number"]]),h.type){case"Register":d=p.SUB_REG_FROM_REG;break;case"Number":d=p.SUB_IMM_FROM_REG;break}break;case v.MUL:switch([f,h]=_([["Register","Register"],["Register","Number"]]),h.type){case"Register":d=p.MUL_REG_BY_REG;break;case"Number":d=p.MUL_REG_BY_IMM;break}break;case v.DIV:switch([f,h]=_([["Register","Register"],["Register","Number"]]),h.type){case"Register":d=p.DIV_REG_BY_REG;break;case"Number":d=p.DIV_REG_BY_IMM;break}break;case v.MOD:switch([f,h]=_([["Register","Register"],["Register","Number"]]),h.type){case"Register":d=p.MOD_REG_BY_REG;break;case"Number":d=p.MOD_REG_BY_IMM;break}break;case v.AND:switch([f,h]=_([["Register","Register"],["Register","Number"]]),h.type){case"Register":d=p.AND_REG_WITH_REG;break;case"Number":d=p.AND_REG_WITH_IMM;break}break;case v.OR:switch([f,h]=_([["Register","Register"],["Register","Number"]]),h.type){case"Register":d=p.OR_REG_WITH_REG;break;case"Number":d=p.OR_REG_WITH_IMM;break}break;case v.XOR:switch([f,h]=_([["Register","Register"],["Register","Number"]]),h.type){case"Register":d=p.XOR_REG_WITH_REG;break;case"Number":d=p.XOR_REG_WITH_IMM;break}break;case v.MOV:switch([f,h]=_([["Register","Number"],["Register","Address"],["Address","Register"],["Register","RegisterAddress"],["RegisterAddress","Register"]]),f.type){case"Register":switch(H(h.type!=="Register"),h.type){case"Number":d=p.MOV_REG_INM;break;case"Address":d=p.MOV_REG_ADDR;break;case"RegisterAddress":d=p.MOV_REG_REGADDR;break}break;case"Address":d=p.MOV_ADDR_REG;break;case"RegisterAddress":d=p.MOV_REGADDR_REG}break;case v.CMP:switch([f,h]=_([["Register","Register"],["Register","Number"],["Register","Address"]]),h.type){case"Register":d=p.CMP_REG_WITH_REG;break;case"Number":d=p.CMP_REG_WITH_IMM;break;case"Address":d=p.CMP_REG_WITH_VAL_FROM_ADDR;break}break}o(d),l(f,h);break}}return ec(t,a,i)},ic=e=>{const t=Xi(e),n=[];for(;t.hasMore();)try{const r=oc(t);if(n.push(r),r.instruction.mnemonic===v.END)break}catch(r){throw r instanceof Gn?new Is:r}if(n.length>0&&n[n.length-1].instruction.mnemonic!==v.END)throw new Is;return n},cc=e=>{const t={},n=e.length;for(let r=0,a=0;a<n;a++){const o=e[a],{label:i,instruction:l,operands:m,codes:R}=o;if(i!==null){if(i.identifier in t)throw new Hi(i);t[i.identifier]=r}const d=m[0];if(l.mnemonic===v.ORG)H(typeof(d==null?void 0:d.code)=="number"),r=d.code;else if(r+=R.length+((d==null?void 0:d.type)===Ut.Label?1:0),r>255&&a!==n-1)throw new Ui(o)}return t},lc=e=>{const t=ic(e),n=cc(t),r={},a={},o=t.length;for(let i=0,l=0;l<o;l++){const m=t[l],{instruction:R,operands:d,codes:f}=m,h=d[0];if(R.mnemonic===v.ORG){H(typeof(h==null?void 0:h.code)=="number"),i=h.code;continue}d.forEach(j=>{if(j.type===Ut.Label){if(!(j.value in n))throw new Wi(j);j.code=n[j.value]}});const _=i+f.length;f.forEach((j,C)=>{r[i+C]=j}),a[i]=m,i=_}return[r,a]},dc=e=>{let t;try{t=lc(e)}catch(a){if(a instanceof _e){const o=a.toPlainObject();g.dispatch(qs(o))}else g.dispatch(ve(a)),g.dispatch(Qs());return}const[n,r]=t;g.dispatch(Xs({source:e,addressToStatementMap:r})),g.dispatch(Dn(n))},Vn=ie(un,en,Vt,(e,t,n)=>{const r=t[e];return r&&r.codes.length&&r.codes.every((a,o)=>a===n[e+o])?r.range:null}),As={type:re.Warning,content:"Warning: Source code has changed since last assemble."};class uc{constructor(){A(this,"stepIntervalId");A(this,"interruptIntervalId");A(this,"isInterruptIntervalSet",!1);A(this,"lastStep",Promise.resolve(null));A(this,"dispatchChangesTimeoutId");A(this,"unsubscribeSetSuspended");A(this,"lastBreakpointLineNumber");A(this,"assemble",()=>{dc(g.getState(We))});A(this,"runOrStop",()=>{this.stopIfRunning()||this.run()});A(this,"stopAndRun",()=>{this.pauseMainLoop(),this.resumeMainLoop(),this.step()});A(this,"step",(t={})=>{this.stepAsync(t)});A(this,"stepAsync",async({isUserAction:t,lastStepResult:n})=>{n===void 0&&(n=await this.lastStep),t&&g.dispatch(et(!1)),this.stepFrom(n)});A(this,"stepFrom",t=>{switch(!0){case g.getState(We)!==g.getState(wa):g.dispatch(ht(As));break;case g.getState(mt)===As:g.dispatch(gt());break}const{fault:n,halted:r}=g.getState(po);if(n!==null||r){this.stopIfRunning(),n===null&&r&&g.dispatch(ut());return}this.lastStep=new Promise(a=>{var w,de,G;let o;try{o=co(t??{memoryData:g.getState(Vt),cpuRegisters:g.getState(go)},g.getState(Uo))}catch(B){if(this.stopIfRunning(),B instanceof Y){const u=B.toPlainObject();g.dispatch(lo(u))}else g.dispatch(ve(B));a(null);return}const{memoryData:i,cpuRegisters:l,signals:m,changes:R}=o,d=(w=R.memoryData)==null?void 0:w.address,f=d!==void 0&&d>=Oe,h=()=>{this.cancelDispatchChanges(),this.dispatchChangesTimeoutId=window.setTimeout(()=>{g.dispatch(uo(l)),g.dispatch(qo(i)),f&&g.dispatch(jn(i)),this.dispatchChangesTimeoutId=void 0})};(!this.willDispatchChanges||f)&&h();const _=g.getState(ye);_&&(((G=(de=R.cpuRegisters)==null?void 0:de.sr)==null?void 0:G.interrupt)??!1)&&(hs(l.sr)?this.isInterruptIntervalSet||this.setInterruptInterval():this.isInterruptIntervalSet&&this.clearInterruptInterval());const{data:j}=m.input,{data:C,expectedInputPort:D}=m.output;if(m.input.interrupt&&g.dispatch(et(!1)),m.output.halted===!0){this.stopIfRunning(),g.dispatch(ut()),a(null);return}m.output.closeWindows===!0&&g.dispatch(Ho());let x=!1;if(D!==void 0)if(g.dispatch(ys(!0)),j.content===null){switch(x=!0,_&&this.pauseMainLoop(),g.dispatch(Ve(!0)),D){case kt.SimulatedKeyboard:g.dispatch(Sn(!0));break}this.unsubscribeSetSuspended=T(g.onAction(Ve).pipe(bt()),()=>{_&&this.resumeMainLoop(),this.step()})}else g.dispatch(js());else g.getState($o)&&(g.dispatch(ys(!1)),g.dispatch(js()));if((C==null?void 0:C.content)!==void 0){const{content:B,port:u}=C,P=At(()=>{switch(u){case dt.TrafficLights:return fe.TrafficLights;case dt.SevenSegmentDisplay:return fe.SevenSegmentDisplay}});P!==void 0&&g.dispatch(yn({name:P,data:B}))}let Q=!1;const S=g.getState(xn);if(S.length&&_&&!x){const B=Rt(g.getState(),P=>{P.cpu.registers=l,P.memory.data=i}),u=Vn(B);if(u){const P=S.find(z=>Ro(z,u));P!==void 0&&(Q=!0,P.number!==this.lastBreakpointLineNumber&&(this.willDispatchChanges||h(),this.stop(),this.lastBreakpointLineNumber=P.number))}}!Q&&this.lastBreakpointLineNumber!==void 0&&this.resetBreakpointLineNumber(),a({memoryData:i,cpuRegisters:l})})});A(this,"reset",()=>{this.resetSelf(),g.dispatch(dn()),g.dispatch(In()),g.dispatch(_n())});A(this,"resetSelf",()=>{this.stopIfRunning(),this.restoreIfSuspended(),this.cancelDispatchChanges(),this.resetBreakpointLineNumber(),this.resetLastStep()})}get willDispatchChanges(){return this.dispatchChangesTimeoutId!==void 0}stopIfRunning(){const t=g.getState(ye);return t&&this.stop(),t}stop(){this.clearStepInterval(),this.isInterruptIntervalSet&&this.clearInterruptInterval(),g.dispatch(as(!1))}clearStepInterval(){window.clearInterval(this.stepIntervalId)}clearInterruptInterval(t=!0){window.clearInterval(this.interruptIntervalId),t&&(this.isInterruptIntervalSet=!1)}async run(){g.dispatch(as(!0)),this.setStepInterval();const t=await this.lastStep;t!==null&&hs(t.cpuRegisters.sr)&&this.setInterruptInterval(),await this.stepAsync({isUserAction:!0,lastStepResult:t})}setStepInterval(){const{clockSpeed:t}=g.getState(it);this.stepIntervalId=window.setInterval(this.step,1e3/t)}setInterruptInterval(t=!0){const{timerInterval:n}=g.getState(it);this.interruptIntervalId=window.setInterval(()=>{g.dispatch(et(!0))},n),t&&(this.isInterruptIntervalSet=!0)}pauseMainLoop(){this.clearStepInterval(),this.isInterruptIntervalSet&&this.clearInterruptInterval(!1)}resumeMainLoop(){this.setStepInterval(),this.isInterruptIntervalSet&&this.setInterruptInterval(!1)}cancelDispatchChanges(){this.dispatchChangesTimeoutId!==void 0&&(window.clearTimeout(this.dispatchChangesTimeoutId),this.dispatchChangesTimeoutId=void 0)}resetBreakpointLineNumber(){this.lastBreakpointLineNumber=void 0}restoreIfSuspended(){g.getState(Ce)&&(this.unsubscribeSetSuspended(),g.dispatch(Ve(!1)))}resetLastStep(){this.lastStep=Promise.resolve(null)}}const pc=()=>{const e=Zs(()=>new uc);return E.useEffect(()=>{const t=g.onState(ot);return T(t.pipe(Et(ct),U(Boolean)),e.assemble)},[e]),E.useEffect(()=>{const t=g.onAction(be);return T(t.pipe(ur(e.resetSelf),U(()=>g.getState(ot)),pr(({isFromFile:n})=>n?hr(ct):Fs(null))),e.assemble)},[e]),E.useEffect(()=>{const t=g.onAction(Xs),n=g.onAction(qs);return T(St(t,n),e.reset)},[e]),E.useEffect(()=>{const t=g.onState(it);return T(t.pipe(U(()=>g.getState(ye)&&!g.getState(Ce))),e.stopAndRun)},[e]),e},Pe=({onClick:e,disabled:t=!1,children:n})=>s.jsx("div",{className:N("flex space-x-2 py-1 px-2 items-center",t?"text-gray-400 fill-gray-400":"hover:bg-gray-200 hover:active:bg-gray-300"),onClick:t?void 0:e,children:n}),hc=()=>{const e=pc(),t=()=>s.jsxs(Pe,{onClick:e.assemble,children:[s.jsx(Kr,{}),s.jsx("span",{children:"Assemble"})]}),n=()=>{const o=I(ye),i=I(Ce);return s.jsx(Pe,{disabled:i,onClick:e.runOrStop,children:o?s.jsxs(s.Fragment,{children:[s.jsx(sa,{}),s.jsx("span",{children:"Stop"})]}):s.jsxs(s.Fragment,{children:[s.jsx(Ws,{}),s.jsxs("span",{children:["Run",je]})]})})},r=()=>{const o=I(ye),i=I(Ce);return s.jsxs(Pe,{disabled:o||i,onClick:e.step.bind(null,{isUserAction:!0}),children:[s.jsx(Xr,{}),s.jsx("span",{children:"Step"})]})},a=()=>s.jsxs(Pe,{onClick:e.reset,children:[s.jsx(na,{}),s.jsx("span",{children:"Reset"})]});return s.jsxs(s.Fragment,{children:[s.jsx(t,{}),s.jsx(n,{}),s.jsx(r,{}),s.jsx(a,{})]})},gc=()=>s.jsx(O,{onClick:()=>{g.dispatch(be({value:Gt.content,isFromFile:!0}))},children:s.jsxs(M,{children:[s.jsx("span",{className:"w-4"}),s.jsx("span",{children:"New File"})]})}),mc=({onFileLoad:e})=>{const t=E.useRef(null),n=i=>{i.stopPropagation(),t.current.click()},r=i=>{i.stopPropagation()},a=i=>{const l=Object.assign(new FileReader,{onload:()=>{H(typeof l.result=="string"),g.dispatch(be({value:l.result,isFromFile:!0}))}});l.readAsText(i)},o=i=>{const l=i.target.files[0];a(l),e()};return s.jsxs(O,{onClick:n,children:[s.jsxs(M,{children:[s.jsx("span",{className:"w-4"}),s.jsx("span",{children:"Open..."})]}),s.jsx("input",{ref:t,className:"hidden",type:"file",onChange:o,onClick:r})]})},xc=()=>s.jsx(O.Expandable,{children:(e,t,n)=>s.jsxs(s.Fragment,{children:[s.jsxs(M,{children:[s.jsx("span",{className:"w-4"}),s.jsx("span",{children:"Open Example"})]}),e&&s.jsx(X.Expanded,{innerRef:t,menuItemElement:n,children:gn.map(({title:r,content:a},o)=>s.jsx(O,{onClick:()=>{g.dispatch(be({value:a,isFromFile:!0}))},children:s.jsxs(M,{children:[s.jsx("span",{className:"w-4"}),s.jsx("span",{children:r})]})},o))})]})}),fc=()=>{const e=()=>{const t=g.getState(We),n=new Blob([t],{type:"application/octet-stream"}),r=URL.createObjectURL(n);Object.assign(document.createElement("a"),{download:"file.asm",href:r}).click(),URL.revokeObjectURL(r)};return s.jsx(O,{onClick:e,children:s.jsxs(M,{children:[s.jsx("span",{className:"w-4"}),s.jsx("span",{children:"Save As..."})]})})},Rc=()=>{const e=t=>{navigator.clipboard.writeText(window.location.href).catch(n=>{t.stopPropagation(),console.error(n)})};return s.jsx(O,{onClick:e,children:s.jsxs(M,{children:[s.jsx("span",{className:"w-4"}),s.jsx("span",{children:"Copy Link"})]})})},bc=()=>s.jsx(Xe,{children:(e,t,n)=>s.jsxs(s.Fragment,{children:[s.jsxs(M.Main,{innerRef:t,children:[s.jsx(Yr,{}),s.jsx("span",{children:"File"})]}),e&&s.jsxs(X,{menuElement:n,children:[s.jsx(gc,{}),s.jsx(mc,{onFileLoad:()=>n.click()}),s.jsx(xc,{}),s.jsx(fc,{}),s.jsx(Rc,{})]})]})}),Ms=document.getElementById("modal-root"),Ec="fixed inset-0 flex items-center justify-center",$t=({className:e,isOpen:t=!1,children:n})=>{const[r,a]=E.useState(null),o=t&&!!r;return E.useEffect(()=>{if(!t)return;const i=Object.assign(document.createElement("div"),{className:lt(Ec,e)});return Ms.appendChild(i),a(i),()=>{Ms.removeChild(i),a(null)}},[t,e]),o&&gr.createPortal(n,r)},Wt=({href:e,name:t})=>s.jsx(O.ExternalLink,{href:e,children:s.jsxs(M,{children:[s.jsx("span",{className:"w-4"}),s.jsx("span",{children:t})]})}),Sc=()=>s.jsx(Wt,{href:"https://nbest.co.uk/Softwareforeducation/sms32v50/sms32v50_manual/250-FullIset.htm",name:"Instruction Set"}),jc=()=>s.jsx(Wt,{href:"https://github.com/ruiz-jose/x86/issues",name:"Report Issue"}),yc=()=>s.jsx(Wt,{href:"https://github.com/ruiz-jose/x86/discussions",name:"Discussions"}),vc=({onClick:e})=>s.jsx(O,{onClick:e,children:s.jsxs(M,{children:[s.jsx("span",{className:"w-4"}),s.jsx("span",{children:"About"})]})}),_c=({isOpen:e,toggleOpen:t})=>{const n=Ct(t),r=a=>{a.stopPropagation()};return s.jsx($t,{className:"bg-black bg-opacity-20",isOpen:e,children:s.jsxs("div",{ref:n,className:"rounded space-y-2 bg-light-100 shadow text-center py-4 px-8 select-text all:select-text",onClick:r,children:[s.jsx("img",{alt:"icon",className:"mx-auto",height:"72",src:"./pwa-192x192.png",width:"72"}),s.jsx("div",{className:"font-bold",children:"Assembler Simulator"}),s.jsxs("div",{className:"space-y-4 text-sm",children:[s.jsxs("div",{children:[s.jsxs("div",{children:["Version:"," ",s.jsx(se,{href:"https://github.com/ruiz-jose/x86/releases",children:"1.0.0-alpha.0"})]}),s.jsxs("div",{children:["Commit:"," ",s.jsx(se,{href:"https://github.com/ruiz-jose/x86/commits/8272651",children:"8272651"})]}),s.jsxs("div",{children:["Date: ","2024-10-06T18:00:17.000Z"]})]}),s.jsxs("div",{children:[s.jsx(se,{href:"https://github.com/ruiz-jose/x86/blob/main/LICENSE",children:"GPL-3.0 License"})," ",s.jsx("span",{className:"font-sans",children:"©"})," 2022-Present"," ",s.jsx(se,{href:"https://github.com/exuanbo",children:"Exuanbo"}),s.jsx(se,{href:"https://github.com/ruiz-jose",children:"ruiz-jose"})]})]})]})})},wc=()=>{const[e,t]=Mt(!1);return s.jsx(Xe,{children:(n,r,a)=>s.jsxs(s.Fragment,{children:[s.jsx(M.Main,{innerRef:r,children:s.jsx(Qr,{})}),n&&s.jsxs(X,{menuElement:a,children:[s.jsx(Sc,{}),s.jsx(jc,{}),s.jsx(yc,{}),s.jsx(vc,{onClick:t})]}),s.jsx(_c,{isOpen:e,toggleOpen:t})]})})},Dc=()=>{const e=I(Ln);return s.jsx(O.Expandable,{children:(t,n,r)=>s.jsxs(s.Fragment,{children:[s.jsxs(M,{children:[s.jsx("span",{className:"w-4"}),s.jsx("span",{children:"Memory"})]}),t&&s.jsx(X.Expanded,{innerRef:n,menuItemElement:r,children:Zo.map((a,o)=>s.jsx(O,{onClick:()=>{g.dispatch(Qo(a))},children:s.jsxs(M,{children:[e===a?s.jsx(we,{}):s.jsx("span",{className:"w-4"}),s.jsx("span",{children:a})]})},o))})]})})},Ic=()=>{const e=I(Jo);return s.jsx(O.Expandable,{children:(t,n,r)=>s.jsxs(s.Fragment,{children:[s.jsxs(M,{children:[s.jsx("span",{className:"w-4"}),s.jsx("span",{children:"I/O Devices"})]}),t&&s.jsx(X.Expanded,{innerRef:n,menuItemElement:r,children:En.map((a,o)=>s.jsx(O,{onClick:()=>{g.dispatch(vn(a))},children:s.jsxs(M,{children:[e[a].isVisible?s.jsx(we,{}):s.jsx("span",{className:"w-4"}),s.jsx("span",{children:la(a)})]})},o))})]})})},Lc=()=>s.jsx(Xe,{children:(e,t,n)=>s.jsxs(s.Fragment,{children:[s.jsxs(M.Main,{innerRef:t,children:[s.jsx(ra,{}),s.jsx("span",{children:"View"})]}),e&&s.jsxs(X,{menuElement:n,children:[s.jsx(Dc,{}),s.jsx(Ic,{})]})]})}),Ac=()=>{const[e,t]=E.useState(null),n=_a(i=>{t(i),o(i)}),r=E.useMemo(()=>({currentOpen:e,setCurrentOpen:n}),[e,n]),a=E.useCallback(()=>{n(null)},[n]),o=Ct(a);return s.jsxs("header",{className:"border-y flex flex-row-reverse min-w-max bg-gray-100 h-8 w-full z-10 fixed items-center justify-between",children:[s.jsxs("div",{className:"flex space-x-2 py-1 px-2 items-center",children:[s.jsx("h1",{children:"Sim-x86"}),s.jsx(se,{href:"https://github.com/ruiz-jose/x86",children:s.jsx(qr,{width:"1.125rem"})})]}),s.jsx("div",{className:"divide-x border-r flex",children:s.jsxs(Nn.Provider,{value:r,children:[s.jsx(bc,{}),s.jsx(Lc,{}),s.jsx(Ai,{}),s.jsx(hc,{}),s.jsx(wc,{})]})})]})},qe=({title:e,onClick:t,children:n})=>{const r=t!==void 0;return s.jsxs("header",{className:N("border-b flex space-x-2 bg-gray-100 py-1 px-2 items-center justify-between",{"cursor-pointer":r}),onClick:t,children:[s.jsx("span",{children:e}),n]})};var He=(e=>(e.Hex="hex",e.Bin="bin",e.Dec="dec",e))(He||{});const Mc=({label:e,value:t,valueClassName:n})=>s.jsx("td",{className:"px-1",children:s.jsxs("div",{className:"flex space-x-1 items-center justify-center",children:[s.jsx("span",{className:"rounded bg-gray-100 text-xs px-1 text-gray-400",children:e}),s.jsx("span",{className:N("rounded text-sm px-1",n),children:t})]})}),Cc=()=>s.jsx("td",{className:"px-1",children:s.jsxs("div",{className:"flex space-x-1 items-center justify-center",children:[s.jsx("span",{className:"text-xs px-1",children:je.repeat(3)}),s.jsx("span",{className:"text-sm px-1",children:`${je.repeat(3)}ISOZC${je}`})]})}),Ue=Object.assign(Mc,{FlagIndicator:Cc}),Nc=({name:e,value:t,valueClassName:n})=>{const r=ne(t),a=Js(t),o=te(t),i=`${o>=0?"+":"-"}${`${Math.abs(o)}`.padStart(3,"0")}`;return s.jsxs("tr",{className:"divide-x",children:[s.jsx("td",{className:"bg-gray-50 text-center px-2",children:e}),s.jsx(Ue,{label:He.Hex,value:r,valueClassName:n}),s.jsx(Ue,{label:He.Bin,value:a}),s.jsx(Ue,{label:He.Dec,value:i})]})},kc=()=>s.jsxs("tr",{children:[s.jsx("td",{children:je}),s.jsx("td",{}),s.jsx(Ue.FlagIndicator,{}),s.jsx("td",{})]}),le=Object.assign(Nc,{FlagIndicator:kc}),Tc=()=>{const e=I(ge(Ze)(W.AL));return s.jsx(le,{name:Te.AL,value:e})},Oc=()=>{const e=I(ge(Ze)(W.BL));return s.jsx(le,{name:Te.BL,value:e})},Gc=()=>{const e=I(ge(Ze)(W.CL));return s.jsx(le,{name:Te.CL,value:e})},Bc=()=>{const e=I(ge(Ze)(W.DL));return s.jsx(le,{name:Te.DL,value:e})},Pc=()=>{const e=I(un);return s.jsx(le,{name:Ke.IP,value:e,valueClassName:"bg-green-100"})},Fc=()=>{const e=I(mo);return s.jsx(le,{name:Ke.SP,value:e,valueClassName:"bg-blue-100"})},Vc=()=>{const e=I(fo);return s.jsx(le,{name:Ke.SR,value:e})},Hc=()=>s.jsxs("div",{className:"border-b",children:[s.jsx(qe,{title:"Registers"}),s.jsxs("div",{className:"divide-x flex",children:[s.jsx("table",{className:"flex-1",children:s.jsxs("tbody",{className:"divide-y",children:[s.jsx(Tc,{}),s.jsx(Oc,{}),s.jsx(Gc,{}),s.jsx(Bc,{})]})}),s.jsx("table",{className:"flex-1",children:s.jsxs("tbody",{className:"divide-y",children:[s.jsx(Pc,{}),s.jsx(Fc,{}),s.jsx(Vc,{}),s.jsx(le.FlagIndicator,{})]})})]})]}),Ne=e=>{const t={isJust:()=>!0,isNothing:()=>!1,map:n=>Ne(n(e)),alt:()=>t,altLazy:()=>t,chain:n=>n(e),orDefault:()=>e,orDefaultLazy:()=>e,filter:n=>n(e)?t:Z,extract:()=>e,extractNullable:()=>e,ifJust:n=>(n(e),t),ifNothing:()=>t};return t},Z={isJust:()=>!1,isNothing:()=>!0,map:()=>Z,alt:e=>e,altLazy:e=>e(),chain:()=>Z,orDefault:e=>e,orDefaultLazy:e=>e(),filter:()=>Z,extract:()=>{},extractNullable:()=>null,ifJust:()=>Z,ifNothing:e=>(e(),Z)},Jt=e=>e!=null?Ne(e):Z,Uc=e=>e?Ne(e):Z,Hn=mr.define(),$c=e=>t=>{const n=[t.annotations??[]].flat();return{...t,annotations:[...n,Hn.of(e)]}},Wc=e=>t=>t.annotation(Hn)===e;var F=(e=>(e.Breakpoint="cm-breakpoint",e.ActiveLine="cm-activeLine",e.ActiveLineGutter="cm-activeLineGutter",e.HighlightLineDefault="cm-highlightLine",e.HighlightLineTransparent="cm-highlightLine--transparent",e.WavyUnderline="cm-wavyUnderline",e))(F||{}),V=(e=>(e.Cursor="cm-cursor",e.CursorPrimary="cm-cursor-primary",e.Focused="cm-focused",e.Scroller="cm-scroller",e.Gutters="cm-gutters",e.GutterElement="cm-gutterElement",e.SelectionMatch="cm-selectionMatch",e.LineNumbers="cm-lineNumbers",e))(V||{});const Qe=jt.define({map(e,t){return{pos:t.mapPos(e.pos),on:e.on}}});class zt extends Vs{eq(t){return t instanceof zt}toDOM(){return document.createTextNode("●")}}const Un=new zt,$n=yt.define({create(){return st.empty},update(e,t){const n=e.map(t.changes);return vt(t.effects,Qe).reduce((r,a)=>_t(a,({pos:o,on:i})=>r.update(i?{add:[Un.range(o)]}:{filter:l=>l!==o})),n)}}),ke=e=>e.field($n),Jc=(e,t)=>{let n=!1;ke(e.state).between(t,t,()=>{n=!0}),e.dispatch({effects:Qe.of({pos:t,on:!n})})},Wn=(e,t,n)=>(H(n instanceof MouseEvent),H(n.target instanceof Element),n.offsetY>t.bottom||n.target.classList.contains(F.Breakpoint)?!1:(Jc(e,t.from),!0)),zc=()=>[$n,xr({class:F.Breakpoint,markers:e=>ke(e.state),initialSpacer:()=>Un,domEventHandlers:{mousedown:Wn}}),J.baseTheme({[`.${F.Breakpoint}`]:{fontSize:"0.875em"},[`.${F.Breakpoint} .${V.GutterElement}`]:{width:"20px",padding:"0 3px 0 5px",color:"red !important",cursor:"pointer"}})],ft=jt.define({map({pos:e,filter:t},n){return{pos:e.map(r=>n.mapPos(r)),filter:t}}}),Cs=oe.line({class:F.HighlightLineDefault}),Ns=oe.line({class:F.HighlightLineTransparent}),Kc=yt.define({create(){return oe.none},update(e,t){const n=e.map(t.changes),r=fr(n,(a,o,i)=>{const m=t.selection!==void 0&&Rs(t.state.doc.lineAt(i),t.selection.ranges)?Ns:Cs;return o.eq(m)?a:a.update({add:[m.range(i)],filter:R=>R!==i})},n);return vt(t.effects,ft).reduce((a,o)=>_t(o,({pos:i,filter:l})=>a.update({add:i.map(m=>[(Rs(t.state.doc.lineAt(m),t.state.selection.ranges)?Ns:Cs).range(m)]).extract(),filter:l})),r)},provide:e=>J.decorations.from(e)}),Zc=()=>[Kc,J.baseTheme({[`.${F.HighlightLineDefault}`]:{backgroundColor:"#dcfce7 !important"},[`.${F.HighlightLineTransparent}`]:{backgroundColor:"#dcfce780 !important"}})],Jn=e=>new Rr(t=>Hs(e,n=>{t.next(n)})),Yc=(e,t)=>({changes:{from:0,to:e.doc.length,insert:t}}),Xc="modulepreload",qc=function(e,t){return new URL(e,t).href},ks={},zn=function(t,n,r){let a=Promise.resolve();if(n&&n.length>0){const o=document.getElementsByTagName("link"),i=document.querySelector("meta[property=csp-nonce]"),l=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.all(n.map(m=>{if(m=qc(m,r),m in ks)return;ks[m]=!0;const R=m.endsWith(".css"),d=R?'[rel="stylesheet"]':"";if(!!r)for(let _=o.length-1;_>=0;_--){const j=o[_];if(j.href===m&&(!R||j.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${d}`))return;const h=document.createElement("link");if(h.rel=R?"stylesheet":Xc,R||(h.as="script",h.crossOrigin=""),h.href=m,l&&h.setAttribute("nonce",l),document.head.appendChild(h),R)return new Promise((_,j)=>{h.addEventListener("load",_),h.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${m}`)))})}))}return a.then(()=>t()).catch(o=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=o,window.dispatchEvent(i),!i.defaultPrevented)throw o})},ae={extension:[],initialized:!1},Qc=br(()=>ae.initialized?ss(Promise.resolve()):ss(zn(()=>import("./index-Cpo0d8wr.js"),__vite__mapDeps([0,1]),import.meta.url)).pipe(k(e=>{ae.extension=e.vim({status:!0}),ae.initialized=!0}))),el=e=>{H(ae.initialized,"Vim extension not initialized."),Er(e,ae)},tl=e=>{Sr(e,ae),ae.extension=[],ae.initialized=!1},Kn=jt.define({map({range:e,filter:t},n){return{range:e.map(({from:r,to:a})=>({from:n.mapPos(r),to:n.mapPos(a)})),filter:t}}}),sl=oe.mark({class:F.WavyUnderline}),nl=yt.define({create(){return oe.none},update(e,t){const n=e.map(t.changes);return vt(t.effects,Kn).reduce((r,a)=>_t(a,({range:o,filter:i})=>r.update({add:o.map(({from:l,to:m})=>[sl.range(l,m)]).extract(),filter:i})),n)},provide:e=>J.decorations.from(e)}),rl=`url('data:image/svg+xml;base64,${window.btoa(`<svg height="4" width="6" xmlns="http://www.w3.org/2000/svg">
  <path fill="none" stroke="red" d="m0 3 l2 -2 l1 0 l2 2 l1 0" />
</svg>`)}')`,al=()=>[nl,J.baseTheme({[`.${F.WavyUnderline}`]:{background:`${rl} left bottom repeat-x`,paddingBottom:"2px"}})],ol=ie([Vn,(e,t)=>t.state.doc],(e,t)=>Jt(e).chain(n=>{const r=[],a=Math.min(n.to,t.length);for(let o=n.from;o<a;o++){const i=t.lineAt(o);r.includes(i.from)||r.push(i.from)}return Uc(r.length&&r)})),q=jr,il=q(e=>{const t=Jn(e);return T(t.pipe(U(n=>n.docChanged),k(()=>Qs())),n=>g.dispatch(n))}),Zn=$c("SyncFromState"),Yn=Wc("SyncFromState"),cl=q(e=>{const t=Jn(e);return T(t.pipe(U(n=>n.docChanged),Et(ct),U(n=>{const r=n.transactions[0];return!r||!Yn(r)}),k(n=>n.state.doc.toString()),k(n=>be({value:n}))),n=>g.dispatch(n))}),ll=q(e=>{const t=g.onAction(be);return T(t.pipe(U(({value:n})=>n!==e.state.doc.toString()),k(({value:n})=>Yc(e.state,n)),k(n=>Zn(n))),n=>e.dispatch(n))}),dl=q(e=>{const t=g.onAction(be);return T(t.pipe(U(({isFromFile:n})=>n),U(({value:n})=>Io(n)),k(()=>({selection:Lo}))),n=>(e.focus(),e.dispatch(n)))}),ul=q(e=>{const t=g.onState(Ia);return T(t.pipe(k(Jt),k(n=>Kn.of({range:n,filter:()=>n.isJust()})),k(n=>({effects:n}))),n=>e.dispatch(n))}),pl=q(e=>{const t=g.onState(ge(ol)(e));return T(t,n=>{n.map(r=>r.map((a,o)=>ft.of({pos:Ne(a),filter:()=>o!==0}))).altLazy(()=>Ne([ft.of({pos:Z,filter:()=>!1})])).map(r=>({effects:r})).ifJust(r=>e.dispatch(r)),n.filter(()=>!e.hasFocus).map(r=>({selection:{anchor:r[0]},scrollIntoView:!0})).ifJust(r=>e.dispatch(r))})}),hl=q(e=>Hs(e,t=>{if(t.docChanged){const n=ke(t.state);if(!yr(n,ke(t.startState))){const r=vr(n,(a,o)=>pt(t.state.doc,o));g.dispatch(mn(r))}}else{const n=t.transactions[0];if(!n||Yn(n))return;n.effects.forEach(r=>{if(r.is(Qe)){const a=r.value.on?Co:No,o=pt(t.state.doc,r.value.pos);g.dispatch(a(o))}})}})),gl=q(e=>{const t=g.getState(xn),n=t.filter(a=>a.to<=e.state.doc.length&&pn(a,pt(e.state.doc,a.from)));if(n.length<t.length&&g.dispatch(mn(n)),n.length===0)return;ke(e.state).size===0&&e.dispatch(Zn({effects:n.map(a=>Qe.of({pos:a.from,on:!0}))}))}),ml=q(e=>{const t=g.onState(tn);return T(t.pipe(wt(n=>n?Qc.pipe(k(()=>el)):Fs(tl))),n=>n(e))}),xl=[il,cl,ll,dl,ul,pl,hl,gl,ml],fl=J.exceptionSink,Rl=e=>fl.of(e),ee={SKIPABLE_CHARACTER:/[,[\]:]/,LABEL_DECLARATION:/^[a-zA-Z_]+(?=:)/,LABEL_REFERENCE:/^[a-zA-Z_]+/,NUMBER:/^[\da-fA-F]+\b/,REGISTER:/^[a-dA-D][lL]\b/,STRING:/^"(?:(?:[^\\]|\\.)*?"|.*)/,UNKNOWN:/^[^\s;:,["]+/,NON_WHITESPACE:/^\S+/,MEMORY_REFERENCE:/^\[([a-zA-Z_]+)\]/},bl=()=>({ended:!1,operandsLeft:0,expectingLabel:!1}),El=_r.define({name:"asm",startState:bl,token(e,t){if(t.ended)return e.skipToEnd(),"comment";if(e.eatSpace()||e.eat(ee.SKIPABLE_CHARACTER))return null;if(e.eat(";"))return e.skipToEnd(),"comment";if(e.match(ee.LABEL_DECLARATION))return t.operandsLeft=0,"labelName";if(t.operandsLeft){if(e.match(ee.NUMBER))return t.operandsLeft-=1,"number";if(e.match(ee.REGISTER))return t.operandsLeft-=1,"variableName.special";if(e.match(ee.STRING))return t.operandsLeft-=1,"string";if(e.match(ee.MEMORY_REFERENCE))return t.operandsLeft-=1,"labelName";t.operandsLeft=0}else if(e.match(ee.UNKNOWN)){const n=e.current().toUpperCase();if(It(n,v)){const r=n;return r===v.END&&(t.ended=!0),t.operandsLeft=sn[r],t.expectingLabel=r.startsWith("J"),"keyword"}else return null}return e.match(ee.NON_WHITESPACE),null},indent(e,t,n){var d;const{selection:r,tabSize:a}=n.state,o=r.main.from,l=(((d=n.lineAt(o,-1).text.match(/^\s+/))==null?void 0:d[0])??"").replace(new RegExp(` {${a}}`,"g"),"	").replace(/ +(?=\t)/g,"").split(""),m=l.reduce((f,h)=>h==="	"?f+1:f,0),R=l.length-m;return m*a+R},languageData:{commentTokens:{line:";"},closeBrackets:{brackets:["[",'"']}}}),Sl=()=>[new wr(El,[Dr.of("	")]),Ir(Lr)],jl=oe.line({class:F.ActiveLine}),yl=Ar.fromClass(class{constructor(t){A(this,"_decorations");this._decorations=this.getDecorations(t)}get decorations(){return this._decorations}update(t){(t.docChanged||t.selectionSet)&&(this._decorations=this.getDecorations(t.view))}getDecorations(t){const n=t.state.selection.ranges;if(n.some(o=>!o.empty))return oe.none;const r=[],a=n.length;for(let o=-1,i=0;i<a;i++){const l=n[i],m=t.state.doc.lineAt(l.head);m.from>o&&(r.push(jl.range(m.from)),o=m.from)}return oe.set(r)}},{decorations:e=>e.decorations}),vl=()=>[yl,J.baseTheme({[`&.${V.Focused} .${F.ActiveLine}`]:{boxShadow:"inset 0 0 0 2px #e5e7eb"},[`.${F.ActiveLine}`]:{backgroundColor:"unset"}})];class _l extends Vs{constructor(){super(...arguments);A(this,"elementClass",F.ActiveLineGutter)}}const wl=new _l,Dl=Mr.compute(["selection"],e=>{const t=e.selection.ranges;if(t.some(a=>!a.empty))return st.empty;const n=[],r=t.length;for(let a=-1,o=0;o<r;o++){const i=t[o],l=e.doc.lineAt(i.head);l.from>a&&(n.push(wl.range(l.from)),a=l.from)}return st.of(n)}),Il=()=>[Dl,J.baseTheme({[`&.${V.Focused} .${F.ActiveLineGutter}`]:{color:"#4b5563"},[`.${F.ActiveLineGutter}`]:{backgroundColor:"unset"}})],Ll=()=>[J.baseTheme({[`.${V.SelectionMatch}`]:{backgroundColor:"#bdcfe480"}}),Cr()],Al={key:"Tab",run:Nr,shift:kr},Ml=(e,t,n)=>(H(n.target instanceof Element),n.target.classList.contains(V.GutterElement)?Wn(e,t,n):!1),Cl=()=>[Tr({domEventHandlers:{mousedown:Ml}}),J.baseTheme({[`.${V.LineNumbers}`]:{paddingRight:"6px"},[`.${V.LineNumbers} .${V.GutterElement}`]:{cursor:"pointer"}})],Nl=()=>J.theme({"&":{height:"100%"},[`&.${V.Focused}`]:{outline:"0"},[`.${V.Scroller}`]:{cursor:"text",fontFamily:"'Jetbrains Mono', monospace"},[`.${V.Gutters}`]:{borderRight:"1px solid #e5e7eb",backgroundColor:"#f3f4f6",cursor:"initial",color:"#9ca3af"},[`.${V.Cursor}`]:{borderLeft:"2px solid black"},[`&:not(.${V.Focused}) .${V.CursorPrimary}`]:{outline:"0 !important"}}),kl=()=>[Or(),Gr(),Br(),Pr(),Fr(),Nl(),Sl(),vl(),Ll(),Il(),zc(),Cl(),al(),Zc(),Vr.of([...Hr,...Ur,...$r,Al])],{useViewEffect:Tl,useContainerRef:Ol}=Wr(()=>{const e=g.getState(We),t=n=>{g.dispatch(ve(n))};return{doc:e,extensions:[kl(),Rl(t)]}}),Gl=2e3,Ts={type:re.Info,content:"Info: Program has halted."},Bl=e=>({type:re.Error,content:`${e.name}: ${e.message}`}),Pl=()=>{const e=I(Da),t=I(ho),n=e??t,r=I(mt);return E.useEffect(()=>{const a=g.onState(mt),o=g.onAction(ut),i=g.onAction(dn);return T(St(o.pipe(k(()=>ht(Ts))),i.pipe(wt(()=>a.pipe(bt())),U(l=>l===Ts),k(()=>gt()))),l=>g.dispatch(l))},[]),E.useEffect(()=>{const a=g.onAction(ht);return T(a.pipe(Et(Gl),U(Boolean),U(({type:o})=>o!==re.Error),k(()=>gt())),o=>g.dispatch(o))},[]),Jt(n).map(Bl).orDefault(r)},Fl=({className:e})=>{const t=Ol();return Tl(n=>{const r=xl.map(a=>a(n));return()=>r.forEach(a=>a==null?void 0:a())}),s.jsx("div",{ref:t,className:N("cursor-auto select-auto overflow-y-auto",e)})},Vl=e=>{switch(e){case re.Error:return"bg-red-500";case re.Warning:return"bg-yellow-500";case re.Info:return"bg-blue-500"}},Hl=()=>{const e=Pl();return e?s.jsx("div",{className:N("py-1 px-2 text-light-100",Vl(e.type)),children:e.content}):null},Ul=()=>s.jsxs("div",{className:"flex flex-col h-full",children:[s.jsx(Fl,{className:"flex-1"}),s.jsx(Hl,{})]});class $l extends E.Component{componentDidCatch(t){this.props.onError(t)}render(){return this.props.children}}const Wl=({children:e})=>{const t=E.useCallback(n=>{g.dispatch(ve(n))},[]);return s.jsx($l,{onError:t,children:e})},Jl=()=>{var a;const e=I(Oo),t=e!==null,n=E.useCallback(()=>{g.dispatch(To())},[]),r=Ct(n);return s.jsx($t,{className:"bg-white bg-opacity-80 z-50",isOpen:t,children:s.jsxs("div",{ref:r,className:"border rounded space-y-2 bg-light-100 shadow py-2 px-4 select-text all:select-text",children:[t?(a=e.stack)==null?void 0:a.split(/\n(.*)/s).slice(0,-1).map((o,i)=>i===0?s.jsx("div",{children:o.split(": ").map((m,R)=>{const d=R===0;return s.jsx("div",{className:d?"text-xl text-red-500":"border-b text-lg py-1",children:m},R)})},i):s.jsx("div",{className:"rounded bg-red-50 py-2 px-5.5 text-gray-600 whitespace-pre-line",children:o},i)):null,s.jsxs("div",{children:["Please report this bug at"," ",s.jsx(se,{href:"https://github.com/ruiz-jose/x86/issues",children:"https://github.com/ruiz-jose/x86/issues"}),"."]})]})})},zl=()=>{E.useEffect(()=>{const e=n=>{g.dispatch(ve(n.error))},t=n=>{g.dispatch(ve(n.reason))};return window.addEventListener("error",e),window.addEventListener("unhandledrejection",t),()=>{window.removeEventListener("error",e),window.removeEventListener("unhandledrejection",t)}},[])},Kt=({name:e,onClose:t,className:n,children:r})=>{const a=t!==void 0;return s.jsxs("div",{className:"border shadow m-1",children:[s.jsx(qe,{title:e,children:a&&s.jsx("span",{className:"rounded-full flex bg-gray-200 h-4 w-4 justify-center group hover:active:bg-gray-300",onClick:t,children:s.jsx(Zr,{className:"fill-none group-hover:fill-gray-400",width:"0.5rem"})})}),s.jsx("div",{className:N("p-1",n),children:r})]})},Zt=e=>{const t=E.useMemo(()=>ge(zo)(e),[e]),n=I(t),r=E.useCallback(i=>{const l=g.onState(t);return T(l,i)},[t]),a=I(E.useMemo(()=>ge(Ko)(e),[e])),o=E.useCallback(()=>{g.dispatch(vn(e))},[e]);return E.useEffect(()=>{if(a)return;const i=g.onAction(yn);return T(i.pipe(U(({name:l})=>l===e)),o)},[e,a,o]),{data:n,subscribeData:r,isVisible:a,toggleVisible:o}},Kl=s.jsxs(s.Fragment,{children:[s.jsx("rect",{fill:"#a1a1aa",height:"300",width:"320",children:s.jsx("title",{children:"Background"})}),s.jsxs("g",{fill:"#000",children:[s.jsx("title",{children:"Screen"}),s.jsx("rect",{height:"128",width:"80",x:"40",y:"56"}),s.jsx("rect",{height:"128",width:"80",x:"192",y:"56"})]}),s.jsxs("g",{fill:"none",stroke:"#fff",strokeWidth:"2",children:[s.jsx("title",{children:"Circut"}),s.jsxs("g",{children:[s.jsx("title",{children:"Digit 0"}),s.jsx("polyline",{points:"100,260 100,248 20,248 20,40 232,40 232,64"}),s.jsx("line",{x1:"80",x2:"80",y1:"40",y2:"64"}),s.jsx("line",{x1:"56",x2:"104",y1:"64",y2:"64"}),s.jsx("line",{x1:"208",x2:"256",y1:"64",y2:"64"})]}),s.jsxs("g",{children:[s.jsx("title",{children:"Digit 1"}),s.jsx("polyline",{points:"116,260 116,240 28,240 28,48 188,48 188,92 204,92"}),s.jsx("line",{x1:"28",x2:"52",y1:"92",y2:"92"}),s.jsx("line",{x1:"52",x2:"52",y1:"68",y2:"116"}),s.jsx("line",{x1:"204",x2:"204",y1:"68",y2:"116"})]}),s.jsxs("g",{children:[s.jsx("title",{children:"Digit 2"}),s.jsx("polyline",{points:"132,260 132,232 36,232 36,148 52,148"}),s.jsx("polyline",{points:"132,232 208,232 208,192 188,192 188,148 204,148"}),s.jsx("line",{x1:"52",x2:"52",y1:"124",y2:"172"}),s.jsx("line",{x1:"204",x2:"204",y1:"124",y2:"172"})]}),s.jsxs("g",{children:[s.jsx("title",{children:"Digit 3"}),s.jsx("polyline",{points:"148,260 148,224 80,224 80,176"}),s.jsx("polyline",{points:"148,224 232,224 232,176"}),s.jsx("line",{x1:"56",x2:"104",y1:"176",y2:"176"}),s.jsx("line",{x1:"208",x2:"256",y1:"176",y2:"176"})]}),s.jsxs("g",{children:[s.jsx("title",{children:"Digit 4"}),s.jsx("polyline",{points:"164,260 164,216 124,216 124,148 108,148"}),s.jsx("polyline",{points:"164,216 276,216 276,148 260,148"}),s.jsx("line",{x1:"108",x2:"108",y1:"124",y2:"172"}),s.jsx("line",{x1:"260",x2:"260",y1:"124",y2:"172"})]}),s.jsxs("g",{children:[s.jsx("title",{children:"Digit 5"}),s.jsx("polyline",{points:"180,260 180,208 132,208 132,120 56,120"}),s.jsx("polyline",{points:"180,208 284,208 284,120 208,120"})]}),s.jsxs("g",{children:[s.jsx("title",{children:"Digit 6"}),s.jsx("polyline",{points:"196,260 196,200 140,200 140,92 108,92"}),s.jsx("polyline",{points:"196,200 292,200 292,92 260,92"}),s.jsx("line",{x1:"108",x2:"108",y1:"68",y2:"116"}),s.jsx("line",{x1:"260",x2:"260",y1:"68",y2:"116"})]}),s.jsxs("g",{children:[s.jsx("title",{children:"Digit 7"}),s.jsx("polyline",{points:"212,260 212,240 300,240 300,24 204,24"}),s.jsxs("g",{fill:"#a1a1aa",children:[s.jsx("title",{children:"Inverter"}),s.jsx("polygon",{points:"204,24 204,14 194,24 204,34 204,24"}),s.jsx("circle",{cx:"190",cy:"24",r:"2"})]}),s.jsx("polyline",{points:"188,24 118,24 118,56"}),s.jsx("line",{x1:"270",x2:"270",y1:"24",y2:"56"})]})]}),s.jsxs("g",{fill:"#fff",children:[s.jsx("title",{children:"Circut Node"}),he(8).map(e=>s.jsx("rect",{height:"8",width:"8",x:96+e*16,y:"260"},e)),he(5).map(e=>s.jsx("rect",{height:"4",width:"8",x:128+e*16,y:230-e*8},e)),s.jsx("rect",{height:"4",width:"8",x:"76",y:"38"}),s.jsx("rect",{height:"4",width:"8",x:"24",y:"90"}),s.jsx("rect",{height:"4",width:"8",x:"266",y:"22"}),s.jsx("rect",{height:"8",width:"8",x:"266",y:"54"}),s.jsx("rect",{height:"8",width:"8",x:"114",y:"54"})]}),s.jsxs("g",{fill:"#fff",textAnchor:"middle",children:[s.jsx("title",{children:"Label"}),s.jsx("text",{x:"60",y:"270",children:"MSB"}),s.jsx("text",{x:"252",y:"270",children:"LSB"})]})]}),Zl=[s.jsx("polygon",{points:"56,64 104,64 96,72 64,72"},0),s.jsx("polygon",{points:"208,64 256,64 248,72 216,72"},1),s.jsx("polygon",{points:"52,68 60,76 60,108 52,116"},2),s.jsx("polygon",{points:"204,68 212,76 212,108 204,116"},3),s.jsx("polygon",{points:"52,124 60,132 60,164 52,172"},4),s.jsx("polygon",{points:"204,124 212,132 212,164 204,172"},5),s.jsx("polygon",{points:"56,176 64,168 96,168 104,176"},6),s.jsx("polygon",{points:"208,176 216,168 248,168 256,176"},7),s.jsx("polygon",{points:"108,124 108,172 100,164 100,132"},8),s.jsx("polygon",{points:"260,124 260,172 252,164 252,132"},9),s.jsx("polygon",{points:"56,120 60,116 100,116 104,120 100,124 60,124"},10),s.jsx("polygon",{points:"208,120 212,116 252,116 256,120 252,124 212,124"},11),s.jsx("polygon",{points:"108,68 108,116 100,108 100,76"},12),s.jsx("polygon",{points:"260,68 260,116 252,108 252,76"},13)],Xn=14,Os=new Array(Xn).fill(0),Yl=()=>{const[e,t]=E.useState(Os);E.useEffect(()=>{const l=g.onAction(_n);return T(l.pipe(k(()=>Os)),t)},[]);const{data:n,subscribeData:r,isVisible:a,toggleVisible:o}=Zt(fe.SevenSegmentDisplay),i=l=>{t(m=>Rt(m,R=>{const d=l[l.length-1];for(let f=d;f<Xn;f+=2)R[f]=l[Math.floor(f/2)]}))};return E.useEffect(()=>r(i),[r]),a?s.jsx(Kt,{name:"Seven-segment Display",onClose:o,children:s.jsxs("svg",{viewBox:"0 0 320 300",width:"320",xmlns:"http://www.w3.org/2000/svg",children:[s.jsxs("g",{children:[s.jsx("title",{children:"Static Layer"}),Kl]}),s.jsxs("g",{fill:"lime",stroke:"lime",strokeWidth:"2",children:[s.jsx("title",{children:"Segments Layer"}),Zl.filter((l,m)=>!!e[m])]}),s.jsxs("g",{fill:"#fff",textAnchor:"middle",children:[s.jsx("title",{children:"Data Layer"}),n.map((l,m)=>s.jsx("text",{x:100+m*16,y:"284",children:l},m))]})]})}):null},Gs=3,Xl=250,ql=()=>{const[e,t]=E.useState(1);return E.useEffect(()=>{const n=window.setInterval(()=>t(r=>(r+1)%(Gs+1)),Xl);return()=>window.clearInterval(n)},[]),s.jsx("span",{className:"inline-block my-auto",children:he(Gs).map(n=>s.jsx("span",{className:N({invisible:n>=e}),children:"."},n))})},Ql=()=>{const e=I(Ce),t=I(Wo),n=e&&t,r=E.useRef(null),a=()=>{window.setTimeout(()=>{var m;(m=r.current)==null||m.focus()})},o=m=>{g.dispatch(Vo({content:m,port:kt.SimulatedKeyboard})),g.dispatch(Ve(!1)),g.dispatch(Sn(!1))},i=m=>{switch(m.key){case"Backspace":o(Le.BS);break;case"Tab":m.preventDefault(),o(Le.TAB);break;case"Enter":o(Le.CR);break;case"Escape":o(on);break}},l=m=>{const R=m.target.value;o(R.charCodeAt(0))};return s.jsxs($t,{className:"bg-black bg-opacity-20 animate-fade-in animate-duration-250",isOpen:n,children:[s.jsxs("div",{className:"rounded bg-light-100 shadow py-4 px-8",children:["Waiting for keyboard input ",s.jsx(ql,{})]}),s.jsx("input",{ref:r,autoFocus:!0,className:"-z-1 absolute",onBlur:a,onChange:l,onKeyDown:i})]})},ed=s.jsxs(s.Fragment,{children:[s.jsx("rect",{fill:"#a1a1aa",height:"120",width:"320",x:"0",y:"120",children:s.jsx("title",{children:"Background"})}),s.jsxs("g",{fill:"#000",children:[s.jsx("title",{children:"Pillar"}),s.jsx("rect",{height:"112",width:"48",x:"32",y:"24"}),s.jsx("rect",{height:"80",width:"16",x:"48",y:"136"}),s.jsx("rect",{height:"12",width:"32",x:"40",y:"216"}),s.jsx("rect",{height:"112",width:"48",x:"232",y:"24"}),s.jsx("rect",{height:"80",width:"16",x:"248",y:"136"}),s.jsx("rect",{height:"12",width:"32",x:"240",y:"216"})]}),s.jsxs("g",{fill:"none",stroke:"#fff",strokeWidth:"2",children:[s.jsx("title",{children:"Circut"}),s.jsx("polyline",{points:"44,44 36,44 36,132 52,132 52,180 100,180 100,200"}),s.jsx("polyline",{points:"44,76 40,76 40,128 56,128 56,176 116,176 116,200"}),s.jsx("polyline",{points:"68,108 72,108 72,132 60,132 60,172 132,172 132,200"}),s.jsx("polyline",{points:"244,44 236,44 236,132 252,132 252,172 148,172 148,200"}),s.jsx("polyline",{points:"244,76 240,76 240,128 256,128 256,176 164,176 164,200"}),s.jsx("polyline",{points:"268,108 272,108 272,132 260,132 260,180 180,180 180,200"}),s.jsx("polyline",{points:"196,200 196,184 276,184 276,160"}),s.jsx("polyline",{points:"212,200 212,188 280,188 280,164"})]}),s.jsxs("g",{fill:"#fff",children:[s.jsx("title",{children:"Circut Node"}),he(8).map(e=>s.jsx("rect",{height:"8",width:"8",x:96+e*16,y:"200"},e))]}),s.jsxs("g",{fill:"#fff",textAnchor:"middle",children:[s.jsx("title",{children:"Label"}),s.jsx("text",{x:"24",y:"210",children:"MSB"}),s.jsx("text",{x:"288",y:"210",children:"LSB"})]})]}),td=["red","yellow","lime"],sd=()=>{const{data:e,isVisible:t,toggleVisible:n}=Zt(fe.TrafficLights);return t?s.jsx(Kt,{name:"Traffic Lights",onClose:n,children:s.jsxs("svg",{viewBox:"0 0 312 240",width:"312",xmlns:"http://www.w3.org/2000/svg",children:[s.jsxs("g",{children:[s.jsx("title",{children:"Static Layer"}),ed]}),s.jsxs("g",{children:[s.jsx("title",{children:"Lights Layer"}),he(6).map(r=>{const a=!!e[r];return s.jsx("circle",{cx:r<3?56:256,cy:44+r%3*32,fill:a?td[r%3]:"none",r:"12"},r)})]}),s.jsxs("g",{fill:"#fff",textAnchor:"middle",children:[s.jsx("title",{children:"Data Layer"}),e.map((r,a)=>s.jsx("text",{x:100+a*16,y:"224",children:r},a))]})]})}):null},nd=()=>{const{data:e,isVisible:t,toggleVisible:n}=Zt(fe.VisualDisplayUnit);return E.useEffect(()=>{const r=g.onAction(Dn),a=g.onAction(In),o=g.onState(Vt);return T(St(r,a).pipe(wt(()=>o.pipe(bt())),k(jn)),i=>g.dispatch(i))},[]),t?s.jsx(Kt,{className:"flex flex-col space-y-1",name:"Visual Display Unit",onClose:n,children:Lt(16,Ea(e)).map((r,a)=>s.jsx("div",{className:"flex space-x-1",children:r.map((o,i)=>s.jsx("div",{className:"bg-gray-200 text-center w-4.5",children:o===" "?je:o},i))},a))}):null},rd=()=>{const[e,t]=Mt(!0),n=e?$s:Us;return s.jsxs("div",{children:[s.jsx(qe,{title:"I/O Devices",onClick:t,children:s.jsx("span",{className:"w-4",children:s.jsx(n,{className:"mx-auto fill-gray-400",width:"0.625rem"})})}),s.jsx(Ql,{}),e&&s.jsxs("div",{className:"flex flex-wrap py-1 px-1 items-start",children:[s.jsx(nd,{}),s.jsx(sd,{}),s.jsx(Yl,{})]})]})},ad=ie(en,e=>()=>{const t=Po(e);return Lt(16,t)}),od=192,id=255,cd=()=>{const[e,t]=Mt(!0),n=e?$s:Us,r=I(Ln),a=r!==Je.Source,o=I(ei),i=I(ad),l=a?o():i(),{ip:m,sp:R}=I(xo);return s.jsxs("div",{className:N({"border-b":e}),children:[s.jsx(qe,{title:"Memory",onClick:t,children:s.jsx("span",{className:"w-4",children:s.jsx(n,{className:"mx-auto fill-gray-400",width:"0.625rem"})})}),e&&s.jsx("table",{className:"text-sm w-full",children:s.jsxs("tbody",{className:"divide-y",children:[s.jsxs("tr",{className:"divide-x bg-gray-50 text-gray-400",children:[s.jsx("td",{}),he(16).map(d=>s.jsx("td",{className:"text-center",children:s.jsx("span",{className:"px-1",children:ne(d)[1]})},d))]}),l.map((d,f)=>s.jsxs("tr",{className:"divide-x",children:[s.jsx("td",{className:"bg-gray-50 text-center text-gray-400",children:s.jsx("span",{className:"px-1",children:ne(f)[1]})}),d.map((h,_)=>{const j=f*16+_;return s.jsx("td",{className:"text-center",children:s.jsx("span",{className:N("inline-block w-full rounded",{"bg-green-100":j===m},a&&{"bg-blue-100":j===R,"bg-blue-50":j>R&&j<=Tt,"bg-yellow-100":j>=od&&j<=id}),children:r===Je.Hexadecimal?(H(typeof h=="number"),ne(h)):h})},_)})]},f))]})})]})},ld=()=>{E.useEffect(()=>{},[])};function dd(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:a,onRegisteredSW:o,onRegisterError:i}=e;let l,m,R;const d=async(h=!0)=>{await m,await(R==null?void 0:R())};async function f(){if("serviceWorker"in navigator){if(l=await zn(async()=>{const{Workbox:h}=await import("./workbox-window.prod.es5-D5gOYdM7.js");return{Workbox:h}},[],import.meta.url).then(({Workbox:h})=>new h("./sw.js",{scope:"./",type:"classic"})).catch(h=>{i==null||i(h)}),!l)return;R=async()=>{await(l==null?void 0:l.messageSkipWaiting())};{let h=!1;const _=()=>{h=!0,l==null||l.addEventListener("controlling",j=>{j.isUpdate&&window.location.reload()}),n==null||n()};l.addEventListener("installed",j=>{typeof j.isUpdate>"u"?typeof j.isExternal<"u"?j.isExternal?_():!h&&(r==null||r()):j.isExternal?window.location.reload():!h&&(r==null||r()):j.isUpdate||r==null||r()}),l.addEventListener("waiting",_),l.addEventListener("externalwaiting",_)}l.register({immediate:t}).then(h=>{o?o("./sw.js",h):a==null||a(h)}).catch(h=>{i==null||i(h)})}}return m=f(),d}function ud(e={}){const{immediate:t=!0,onNeedRefresh:n,onOfflineReady:r,onRegistered:a,onRegisteredSW:o,onRegisterError:i}=e,[l,m]=E.useState(!1),[R,d]=E.useState(!1),[f]=E.useState(()=>dd({immediate:t,onOfflineReady(){d(!0),r==null||r()},onNeedRefresh(){m(!0),n==null||n()},onRegistered:a,onRegisteredSW:o,onRegisterError:i}));return{needRefresh:[l,m],offlineReady:[R,d],updateServiceWorker:f}}const Bs=({onClick:e,children:t})=>s.jsx("div",{className:"border rounded bg-gray-100 py-1 px-2 inline-block hover:bg-gray-200",onClick:e,children:t}),pd=()=>{const{needRefresh:[e,t],updateServiceWorker:n}=ud(),[r,a]=E.useState(!1),o=()=>{a(!0),n(!0)},i=()=>{t(!1)};return r?s.jsx("div",{className:"bg-white flex bg-opacity-80 inset-0 z-10 fixed justify-center items-center",children:s.jsx(ta,{className:"animate-spin",width:"1.5rem"})}):e?s.jsxs("div",{className:"border rounded space-y-2 bg-light-100 shadow py-2 px-4 right-4 bottom-4 fixed",children:[s.jsx("div",{children:"New version is available"}),s.jsxs("div",{className:"space-x-2",children:[s.jsx(Bs,{onClick:o,children:"Reload"}),s.jsx(Bs,{onClick:i,children:"Close"})]})]}):null},qn=10,hd=500,gd=.25,Ps=.75,Fe=e=>e.current.offsetWidth,md=({children:[e,t],throttle:n=qn,className:r})=>{const a=E.useRef(null),o=E.useRef(null),i=E.useRef(null),l=E.useCallback(()=>Fe(a)-Fe(o),[]),m=E.useCallback(()=>_(l()/2),[l]),R=E.useCallback(()=>l()-Fe(i),[l]),[d,f]=E.useState(),h=d!==void 0,_=S=>{const w=Math.round(S);f(w)};E.useLayoutEffect(()=>{h||m()},[h,m]),E.useLayoutEffect(()=>{if(d!==void 0){const S=R();d>S&&_(S)}},[R,d]);const[j,C]=E.useState(!1),D=E.useRef(0),x=E.useRef(),Q=()=>{C(!0),D.current+=1,D.current===2?(m(),window.clearTimeout(x.current),D.current=0):x.current=window.setTimeout(()=>{D.current=0},hd)};return E.useEffect(()=>{if(!j)return;const S=va(de=>{const G=Fe(o),B=de.clientX-G/2,u=l(),P=B/u,z=ca(P,gd,Ps),Be=z*u;if(z===Ps){const De=R();if(Be>De){_(De);return}}_(Be)},n),w=()=>{C(!1)};return document.addEventListener("mousemove",S),document.addEventListener("mouseup",w),()=>{document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",w)}},[R,l,j,n]),s.jsxs(s.Fragment,{children:[s.jsxs("div",{ref:a,className:N("flex",r),children:[s.jsx("div",{className:N({hidden:!h}),style:{width:d},children:e}),s.jsx("div",{ref:o,className:N("border-x cursor-col-resize flex flex-col space-y-2 px-1 justify-center group hover:bg-gray-200",h?j?"bg-gray-200":"bg-gray-100":"invisible"),onMouseDown:Q,children:he(3).map(S=>s.jsx("span",{className:N("rounded-full h-1 w-1 group-hover:bg-slate-400",j?"bg-slate-400":"bg-slate-300")},S))}),s.jsx("div",{ref:i,className:N("flex-1",{hidden:!h}),children:t})]}),j&&s.jsx("div",{className:"cursor-col-resize inset-0 z-10 fixed"})]})},xd=e=>{const t=I(ye),n=qn*(t?2:1);return s.jsx(md,{throttle:n,...e})},fd=()=>(zl(),ld(),s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx(Ac,{}),s.jsxs(xd,{className:"h-[calc(100vh-2rem)] w-full top-8 fixed",children:[s.jsx(Wl,{children:s.jsx(Ul,{})}),s.jsxs("div",{className:"flex flex-col h-full overflow-y-auto",children:[s.jsx(Hc,{}),s.jsx(cd,{}),s.jsx(rd,{})]})]})]}),s.jsx(pd,{}),s.jsx(Jl,{})]})),Rd=document.getElementById("app-root"),bd=Jr(Rd);bd.render(s.jsx(E.StrictMode,{children:s.jsx(fd,{})}));
